<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Simple tools for networking / objects in plain C: BF</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Simple tools for networking / objects in plain C&#160;<span id="projectnumber">Snapshot</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Defines</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">BF</div>  </div>
</div>
<div class="contents">

<p>protocol buffer. idea similar to skb_buff The following invariants hold  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00002.html">tagBF</a></td></tr>
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00009.html#ga1b2a5ce67eaea3e8012a2552924c4d7b">BF_DECLARE_PUT_MACRO</a>(type)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00009.html#gaef54a2ad2476088707dd143fd0c36c6e">BF_DECLARE_GET_MACRO</a>(type)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00009.html#ga543fba03a17673a12a4b217faa808b05">BF_DECLARE_PUT_UNSAFE_MACRO</a>(type)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00009.html#ga94ea6669521af770786a977fb521707b">BF_DECLARE_GET_UNSAFE_MACRO</a>(type)</td></tr>
<tr><td colspan="2"><h2><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="a00002.html">tagBF</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00009.html#gac141d99aa0f78cafd2acf074517a38cf">BF</a></td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">M_INLINE void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00009.html#gae0c0c2e9bd1e5315aead6fe6554b55b2">BF_init</a> (<a class="el" href="a00002.html">BF</a> *bf, void *buffer, size_t buffer_size)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">initialise an empty protocol buffer object. start and end cover the whole memory range. nitiay get and put pointer are set to start of range.  <a href="#gae0c0c2e9bd1e5315aead6fe6554b55b2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00009.html#ga9a5012a3895ade56ca7b1a8bb7309c72">BF_check</a> (<a class="el" href="a00002.html">BF</a> *bf)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">validates a buffer - checks all invariants.  <a href="#ga9a5012a3895ade56ca7b1a8bb7309c72"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">M_INLINE void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00009.html#ga4ef6aded05e4a4d6669d269775573d3f">BF_get_mode</a> (<a class="el" href="a00002.html">BF</a> *bf)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">set pointers so that we can 'get' the whole range from start to end.  <a href="#ga4ef6aded05e4a4d6669d269775573d3f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">M_INLINE void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00009.html#ga26e937b842b116933b58d6a1dd6e6b3a">BF_put_mode</a> (<a class="el" href="a00002.html">BF</a> *bf)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">set pointers so that we can 'put' the whole range from start to end.  <a href="#ga26e937b842b116933b58d6a1dd6e6b3a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00009.html#ga18fdd2d33720298f25059429d226d9b2">BF_set_start</a> (<a class="el" href="a00002.html">BF</a> *bf, size_t pos)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">set start position, position is relative to start of memory range.  <a href="#ga18fdd2d33720298f25059429d226d9b2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00009.html#ga56338e4b6e732eea198fb266dfa55198">BF_set_end</a> (<a class="el" href="a00002.html">BF</a> *bf, size_t pos)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">set end position, position is relative to start of memory range.  <a href="#ga56338e4b6e732eea198fb266dfa55198"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00009.html#gaacf9d4de524e47e30360e243d39c0f73">BF_set_get</a> (<a class="el" href="a00002.html">BF</a> *bf, size_t pos)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">set get position, position is relative to 'start' pointer.  <a href="#gaacf9d4de524e47e30360e243d39c0f73"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00009.html#ga3d4956583a84d460393dd68dca32f6ac">BF_set_put</a> (<a class="el" href="a00002.html">BF</a> *bf, size_t pos)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">set put position, position is relative to 'start' pointer.  <a href="#ga3d4956583a84d460393dd68dca32f6ac"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">M_INLINE size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00009.html#ga95f015cf316f26ce7d0ae42feef8a45f">BF_can_get</a> (<a class="el" href="a00002.html">BF</a> *bf)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">returns number of bytes that cam be read from this buffer (i.e. that BF_get_(type) return )  <a href="#ga95f015cf316f26ce7d0ae42feef8a45f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">M_INLINE size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00009.html#ga9e4f956930808566d42dd85d4b0ce24d">BF_can_put</a> (<a class="el" href="a00002.html">BF</a> *bf)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">returns number of bytes that cam be placed into this buffer (i.e. that BF_put_(type) places into this buffer )  <a href="#ga9e4f956930808566d42dd85d4b0ce24d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00009.html#ga37819d2886490c212763c865c33364db">BF_compact</a> (<a class="el" href="a00002.html">BF</a> *bf)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">moves get_pos to start position; moves content between get_pos and put_pos if not empty.a Always succeeds returns 0 if bytes were moved, 1 if buffer was empty to begin with.  <a href="#ga37819d2886490c212763c865c33364db"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int8_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00009.html#ga09cbe8980a7c0db771e0d6d93235a1d5">BF_get_line</a> (<a class="el" href="a00002.html">BF</a> *bf, int eof_line)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int8_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00009.html#gadac43bf1b5b17fe81e700cf4dfb9ee32">BF_get_line_ext</a> (<a class="el" href="a00002.html">BF</a> *bf, int8_t *eof_line, size_t eof_line_size)</td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<p>protocol buffer. idea similar to skb_buff The following invariants hold </p>
<p>START_OF_BUFFER &lt;= start &lt;= get_pos &lt;= put_pos &lt;= end &lt;= END_OF_BUFFER.</p>
<p>The effective buffer ranges from start up to end pointers - the range [start end) start may be larger than START_OF_BUFFER, as a way of reserving room for a header. end may be less than END_OF_BUFFER, as a way of reserving root for a footer.</p>
<p>the get_pos position will advance as data is returned from the buffer the pus_pos position will advance, as data is placed int the buffer. </p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="gaef54a2ad2476088707dd143fd0c36c6e"></a><!-- doxytag: member="bf.h::BF_DECLARE_GET_MACRO" ref="gaef54a2ad2476088707dd143fd0c36c6e" args="(type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BF_DECLARE_GET_MACRO</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">type</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">M_INLINE <span class="keywordtype">int</span> BF_get_##type ( <a class="code" href="a00002.html">BF</a> *bf, type *pval ) \
{ \
   <span class="keywordflow">if</span> ((bf-&gt;put_pos - bf-&gt;get_pos) &lt; (ptrdiff_t) <span class="keyword">sizeof</span>( type ) ) { \
     <span class="keywordflow">return</span> -1 ; \
   } \
   *pval = n2h_##type( *( ( type *) bf-&gt;get_pos) ); \
   bf-&gt;get_pos += <span class="keyword">sizeof</span>( type ); \
   <span class="keywordflow">return</span> 0; \
}
</pre></div>
<p>Definition at line <a class="el" href="a00005_source.html#l00151">151</a> of file <a class="el" href="a00005_source.html">bf.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga94ea6669521af770786a977fb521707b"></a><!-- doxytag: member="bf.h::BF_DECLARE_GET_UNSAFE_MACRO" ref="ga94ea6669521af770786a977fb521707b" args="(type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BF_DECLARE_GET_UNSAFE_MACRO</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">type</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">M_INLINE type BF_get_unsafe_##type ( <a class="code" href="a00002.html">BF</a> *bf ) { \
   type rval = n2h_##type( *( ( type *) bf-&gt;<a class="code" href="a00002.html#aa86484010e3b771e8dd1fe54cc8a0318">get_pos</a>) ); \
   bf-&gt;<a class="code" href="a00002.html#aa86484010e3b771e8dd1fe54cc8a0318">get_pos</a> += <span class="keyword">sizeof</span>( type ); \
   <span class="keywordflow">return</span> rval; \
}
</pre></div>
<p>Definition at line <a class="el" href="a00005_source.html#l00188">188</a> of file <a class="el" href="a00005_source.html">bf.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga1b2a5ce67eaea3e8012a2552924c4d7b"></a><!-- doxytag: member="bf.h::BF_DECLARE_PUT_MACRO" ref="ga1b2a5ce67eaea3e8012a2552924c4d7b" args="(type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BF_DECLARE_PUT_MACRO</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">type</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">M_INLINE <span class="keywordtype">int</span> BF_put_##type ( <a class="code" href="a00002.html">BF</a> *bf, type val ) \
{ \
   <span class="keywordflow">if</span> ((bf-&gt;end - bf-&gt;put_pos) &lt; (ptrdiff_t) <span class="keyword">sizeof</span>( type ) ) { \
     <span class="keywordflow">return</span> -1 ; \
   } \
   <span class="keywordflow">do</span> { \
     type nval = h2n_##type ( val ); \
     *( ( type *) bf-&gt;put_pos) = nval; \
     bf-&gt;put_pos += <span class="keyword">sizeof</span> ( type ); \
   } <span class="keywordflow">while</span>(0); \
   <span class="keywordflow">return</span> 0; \
}
</pre></div>
<p>Definition at line <a class="el" href="a00005_source.html#l00127">127</a> of file <a class="el" href="a00005_source.html">bf.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga543fba03a17673a12a4b217faa808b05"></a><!-- doxytag: member="bf.h::BF_DECLARE_PUT_UNSAFE_MACRO" ref="ga543fba03a17673a12a4b217faa808b05" args="(type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BF_DECLARE_PUT_UNSAFE_MACRO</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">type</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">M_INLINE <span class="keywordtype">void</span> BF_put_unsafe_##type ( <a class="code" href="a00002.html">BF</a> *bf, type val ) \
{ \
  type nval = h2n_##type ( val ); \
  *( ( type *) bf-&gt;put_pos) = nval; \
  bf-&gt;put_pos += <span class="keyword">sizeof</span> ( type ); \
}
</pre></div>
<p>Definition at line <a class="el" href="a00005_source.html#l00171">171</a> of file <a class="el" href="a00005_source.html">bf.h</a>.</p>

</div>
</div>
<hr/><h2>Typedef Documentation</h2>
<a class="anchor" id="gac141d99aa0f78cafd2acf074517a38cf"></a><!-- doxytag: member="bf.h::BF" ref="gac141d99aa0f78cafd2acf074517a38cf" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="a00002.html">tagBF</a>  <a class="el" href="a00002.html">BF</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ga95f015cf316f26ce7d0ae42feef8a45f"></a><!-- doxytag: member="bf.h::BF_can_get" ref="ga95f015cf316f26ce7d0ae42feef8a45f" args="(BF *bf)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">M_INLINE size_t BF_can_get </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00002.html">BF</a> *&#160;</td>
          <td class="paramname"><em>bf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>returns number of bytes that cam be read from this buffer (i.e. that BF_get_(type) return ) </p>

<p>Definition at line <a class="el" href="a00005_source.html#l00095">95</a> of file <a class="el" href="a00005_source.html">bf.h</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">return</span> bf-&gt;<a class="code" href="a00002.html#ac9b79e4f9d3b631ff510229a4e6bf778">put_pos</a> - bf-&gt;<a class="code" href="a00002.html#aa86484010e3b771e8dd1fe54cc8a0318">get_pos</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ga9e4f956930808566d42dd85d4b0ce24d"></a><!-- doxytag: member="bf.h::BF_can_put" ref="ga9e4f956930808566d42dd85d4b0ce24d" args="(BF *bf)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">M_INLINE size_t BF_can_put </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00002.html">BF</a> *&#160;</td>
          <td class="paramname"><em>bf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>returns number of bytes that cam be placed into this buffer (i.e. that BF_put_(type) places into this buffer ) </p>

<p>Definition at line <a class="el" href="a00005_source.html#l00103">103</a> of file <a class="el" href="a00005_source.html">bf.h</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">return</span> bf-&gt;<a class="code" href="a00002.html#a8bad05ec0bc08aa74b2cbf13a7c9aac5">end</a> - bf-&gt;<a class="code" href="a00002.html#ac9b79e4f9d3b631ff510229a4e6bf778">put_pos</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ga9a5012a3895ade56ca7b1a8bb7309c72"></a><!-- doxytag: member="bf.h::BF_check" ref="ga9a5012a3895ade56ca7b1a8bb7309c72" args="(BF *bf)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BF_check </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00002.html">BF</a> *&#160;</td>
          <td class="paramname"><em>bf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>validates a buffer - checks all invariants. </p>

<p>Definition at line <a class="el" href="a00004_source.html#l00053">53</a> of file <a class="el" href="a00004_source.html">bf.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    uint8_t * eof;
    
    <span class="keywordflow">if</span> (bf-&gt;<a class="code" href="a00002.html#a8c4f938c3bda8c2f8c7642c285cd5d07">bf</a> &gt; bf-&gt;<a class="code" href="a00002.html#ad13dc2d65892a509ccd131031b401a91">start</a>) {
      <span class="keywordflow">return</span> 1;
    }
    <span class="keywordflow">if</span> (bf-&gt;<a class="code" href="a00002.html#ad13dc2d65892a509ccd131031b401a91">start</a> &gt; bf-&gt;<a class="code" href="a00002.html#aa86484010e3b771e8dd1fe54cc8a0318">get_pos</a>)  {
      <span class="keywordflow">return</span> 2;
    }
    <span class="keywordflow">if</span> (bf-&gt;<a class="code" href="a00002.html#aa86484010e3b771e8dd1fe54cc8a0318">get_pos</a> &gt; bf-&gt;<a class="code" href="a00002.html#ac9b79e4f9d3b631ff510229a4e6bf778">put_pos</a>) {
      <span class="keywordflow">return</span> 3;
    }
    <span class="keywordflow">if</span> (bf-&gt;<a class="code" href="a00002.html#ac9b79e4f9d3b631ff510229a4e6bf778">put_pos</a> &gt; bf-&gt;<a class="code" href="a00002.html#a8bad05ec0bc08aa74b2cbf13a7c9aac5">end</a>) {
      <span class="keywordflow">return</span> 4;
    }
    eof = bf-&gt;<a class="code" href="a00002.html#a8c4f938c3bda8c2f8c7642c285cd5d07">bf</a> + bf-&gt;<a class="code" href="a00002.html#a709816af50943e6e155436fba2fc892c">bf_size</a>;
    <span class="keywordflow">if</span> (bf-&gt;<a class="code" href="a00002.html#a8bad05ec0bc08aa74b2cbf13a7c9aac5">end</a> &gt; eof) {
      <span class="keywordflow">return</span> 5;
    }
    <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ga37819d2886490c212763c865c33364db"></a><!-- doxytag: member="bf.h::BF_compact" ref="ga37819d2886490c212763c865c33364db" args="(BF *bf)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BF_compact </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00002.html">BF</a> *&#160;</td>
          <td class="paramname"><em>bf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>moves get_pos to start position; moves content between get_pos and put_pos if not empty.a Always succeeds returns 0 if bytes were moved, 1 if buffer was empty to begin with. </p>

<p>Definition at line <a class="el" href="a00004_source.html#l00005">5</a> of file <a class="el" href="a00004_source.html">bf.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (bf-&gt;<a class="code" href="a00002.html#aa86484010e3b771e8dd1fe54cc8a0318">get_pos</a> != bf-&gt;<a class="code" href="a00002.html#ac9b79e4f9d3b631ff510229a4e6bf778">put_pos</a>) {
        memmove( bf-&gt;<a class="code" href="a00002.html#ad13dc2d65892a509ccd131031b401a91">start</a>, bf-&gt;<a class="code" href="a00002.html#aa86484010e3b771e8dd1fe54cc8a0318">get_pos</a>, bf-&gt;<a class="code" href="a00002.html#ac9b79e4f9d3b631ff510229a4e6bf778">put_pos</a> - bf-&gt;<a class="code" href="a00002.html#aa86484010e3b771e8dd1fe54cc8a0318">get_pos</a> );
        <span class="keywordflow">return</span> 0;
    } <span class="keywordflow">else</span> {
        bf-&gt;<a class="code" href="a00002.html#aa86484010e3b771e8dd1fe54cc8a0318">get_pos</a> = bf-&gt;<a class="code" href="a00002.html#ac9b79e4f9d3b631ff510229a4e6bf778">put_pos</a> = bf-&gt;<a class="code" href="a00002.html#ad13dc2d65892a509ccd131031b401a91">start</a>;
        <span class="keywordflow">return</span> 1;
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="ga09cbe8980a7c0db771e0d6d93235a1d5"></a><!-- doxytag: member="bf.h::BF_get_line" ref="ga09cbe8980a7c0db771e0d6d93235a1d5" args="(BF *bf, int eof_line)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int8_t* BF_get_line </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00002.html">BF</a> *&#160;</td>
          <td class="paramname"><em>bf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>eof_line</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>@ brief get the next line. </p>

<p>Definition at line <a class="el" href="a00004_source.html#l00016">16</a> of file <a class="el" href="a00004_source.html">bf.c</a>.</p>
<div class="fragment"><pre class="fragment">{  
   int8_t *eof_line, *ret;

   eof_line =  memchr(bf-&gt;<a class="code" href="a00002.html#aa86484010e3b771e8dd1fe54cc8a0318">get_pos</a>, eof, bf-&gt;<a class="code" href="a00002.html#ac9b79e4f9d3b631ff510229a4e6bf778">put_pos</a> - bf-&gt;<a class="code" href="a00002.html#aa86484010e3b771e8dd1fe54cc8a0318">get_pos</a> );
   <span class="keywordflow">if</span> (eof_line) {
      ret = (int8_t *) bf-&gt;<a class="code" href="a00002.html#aa86484010e3b771e8dd1fe54cc8a0318">get_pos</a>;
      *eof_line = <span class="charliteral">&#39;\0&#39;</span>;
      bf-&gt;<a class="code" href="a00002.html#aa86484010e3b771e8dd1fe54cc8a0318">get_pos</a> = (uint8_t *) eof_line + 1;
      <span class="keywordflow">return</span> ret;
   }
   <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="gadac43bf1b5b17fe81e700cf4dfb9ee32"></a><!-- doxytag: member="bf.h::BF_get_line_ext" ref="gadac43bf1b5b17fe81e700cf4dfb9ee32" args="(BF *bf, int8_t *eof_line, size_t eof_line_size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int8_t* BF_get_line_ext </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00002.html">BF</a> *&#160;</td>
          <td class="paramname"><em>bf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int8_t *&#160;</td>
          <td class="paramname"><em>eof_line</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>eof_line_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>@ brief get the next line. </p>

<p>Definition at line <a class="el" href="a00004_source.html#l00030">30</a> of file <a class="el" href="a00004_source.html">bf.c</a>.</p>
<div class="fragment"><pre class="fragment">{
   uint8_t *pos,*next,*ret;
   
   pos = bf-&gt;<a class="code" href="a00002.html#aa86484010e3b771e8dd1fe54cc8a0318">get_pos</a>;

   <span class="keywordflow">do</span> {
     next = memchr( pos, *eof_line, bf-&gt;<a class="code" href="a00002.html#ac9b79e4f9d3b631ff510229a4e6bf778">put_pos</a> - pos );
     <span class="keywordflow">if</span> (!next) {
       <span class="keywordflow">return</span> 0;
     }
     <span class="keywordflow">if</span> (memcmp(next, eof_line, eof_line_size) == 0) {
        ret = bf-&gt;<a class="code" href="a00002.html#aa86484010e3b771e8dd1fe54cc8a0318">get_pos</a>;
        *next = <span class="charliteral">&#39;\0&#39;</span>;
        bf-&gt;<a class="code" href="a00002.html#aa86484010e3b771e8dd1fe54cc8a0318">get_pos</a> = next + eof_line_size;
        <span class="keywordflow">return</span> (int8_t *) ret;
     }
     pos = next + 1;
   } <span class="keywordflow">while</span>( pos &lt; bf-&gt;put_pos );

   <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ga4ef6aded05e4a4d6669d269775573d3f"></a><!-- doxytag: member="bf.h::BF_get_mode" ref="ga4ef6aded05e4a4d6669d269775573d3f" args="(BF *bf)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">M_INLINE void BF_get_mode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00002.html">BF</a> *&#160;</td>
          <td class="paramname"><em>bf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>set pointers so that we can 'get' the whole range from start to end. </p>

<p>Definition at line <a class="el" href="a00005_source.html#l00055">55</a> of file <a class="el" href="a00005_source.html">bf.h</a>.</p>
<div class="fragment"><pre class="fragment">{
    bf-&gt;<a class="code" href="a00002.html#aa86484010e3b771e8dd1fe54cc8a0318">get_pos</a> = bf-&gt;<a class="code" href="a00002.html#ad13dc2d65892a509ccd131031b401a91">start</a>;
    bf-&gt;<a class="code" href="a00002.html#ac9b79e4f9d3b631ff510229a4e6bf778">put_pos</a> = bf-&gt;<a class="code" href="a00002.html#a8bad05ec0bc08aa74b2cbf13a7c9aac5">end</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="gae0c0c2e9bd1e5315aead6fe6554b55b2"></a><!-- doxytag: member="bf.h::BF_init" ref="gae0c0c2e9bd1e5315aead6fe6554b55b2" args="(BF *bf, void *buffer, size_t buffer_size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">M_INLINE void BF_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00002.html">BF</a> *&#160;</td>
          <td class="paramname"><em>bf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>buffer_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>initialise an empty protocol buffer object. start and end cover the whole memory range. nitiay get and put pointer are set to start of range. </p>

<p>Definition at line <a class="el" href="a00005_source.html#l00036">36</a> of file <a class="el" href="a00005_source.html">bf.h</a>.</p>
<div class="fragment"><pre class="fragment">{
   bf-&gt;<a class="code" href="a00002.html#a8c4f938c3bda8c2f8c7642c285cd5d07">bf</a> =  (uint8_t *) buffer;
   bf-&gt;<a class="code" href="a00002.html#a709816af50943e6e155436fba2fc892c">bf_size</a> = buffer_size;

   bf-&gt;<a class="code" href="a00002.html#ad13dc2d65892a509ccd131031b401a91">start</a> =   (uint8_t *) buffer;
   bf-&gt;<a class="code" href="a00002.html#a8bad05ec0bc08aa74b2cbf13a7c9aac5">end</a> = buffer + buffer_size;

   bf-&gt;<a class="code" href="a00002.html#aa86484010e3b771e8dd1fe54cc8a0318">get_pos</a> = bf-&gt;<a class="code" href="a00002.html#ac9b79e4f9d3b631ff510229a4e6bf778">put_pos</a> = bf-&gt;<a class="code" href="a00002.html#ad13dc2d65892a509ccd131031b401a91">start</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ga26e937b842b116933b58d6a1dd6e6b3a"></a><!-- doxytag: member="bf.h::BF_put_mode" ref="ga26e937b842b116933b58d6a1dd6e6b3a" args="(BF *bf)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">M_INLINE void BF_put_mode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00002.html">BF</a> *&#160;</td>
          <td class="paramname"><em>bf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>set pointers so that we can 'put' the whole range from start to end. </p>

<p>Definition at line <a class="el" href="a00005_source.html#l00065">65</a> of file <a class="el" href="a00005_source.html">bf.h</a>.</p>
<div class="fragment"><pre class="fragment">{
    bf-&gt;<a class="code" href="a00002.html#aa86484010e3b771e8dd1fe54cc8a0318">get_pos</a> = bf-&gt;<a class="code" href="a00002.html#ad13dc2d65892a509ccd131031b401a91">start</a>;
    bf-&gt;<a class="code" href="a00002.html#ac9b79e4f9d3b631ff510229a4e6bf778">put_pos</a> = bf-&gt;<a class="code" href="a00002.html#ad13dc2d65892a509ccd131031b401a91">start</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ga56338e4b6e732eea198fb266dfa55198"></a><!-- doxytag: member="bf.h::BF_set_end" ref="ga56338e4b6e732eea198fb266dfa55198" args="(BF *bf, size_t pos)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BF_set_end </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00002.html">BF</a> *&#160;</td>
          <td class="paramname"><em>bf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>pos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>set end position, position is relative to start of memory range. </p>

<p>Definition at line <a class="el" href="a00004_source.html#l00096">96</a> of file <a class="el" href="a00004_source.html">bf.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> (pos &gt; bf-&gt;<a class="code" href="a00002.html#a709816af50943e6e155436fba2fc892c">bf_size</a>) {
    <span class="keywordflow">return</span> -1;
  }
  bf-&gt;<a class="code" href="a00002.html#a8bad05ec0bc08aa74b2cbf13a7c9aac5">end</a> = bf-&gt;<a class="code" href="a00002.html#a8c4f938c3bda8c2f8c7642c285cd5d07">bf</a> + pos;

  <span class="keywordflow">if</span> (bf-&gt;<a class="code" href="a00002.html#a8bad05ec0bc08aa74b2cbf13a7c9aac5">end</a> &lt; bf-&gt;<a class="code" href="a00002.html#aa86484010e3b771e8dd1fe54cc8a0318">get_pos</a>) {
     bf-&gt;<a class="code" href="a00002.html#aa86484010e3b771e8dd1fe54cc8a0318">get_pos</a> = bf-&gt;<a class="code" href="a00002.html#a8bad05ec0bc08aa74b2cbf13a7c9aac5">end</a>;
  }
  <span class="keywordflow">if</span> (bf-&gt;<a class="code" href="a00002.html#a8bad05ec0bc08aa74b2cbf13a7c9aac5">end</a> &lt; bf-&gt;<a class="code" href="a00002.html#ac9b79e4f9d3b631ff510229a4e6bf778">put_pos</a>) {
     bf-&gt;<a class="code" href="a00002.html#ac9b79e4f9d3b631ff510229a4e6bf778">put_pos</a> = bf-&gt;<a class="code" href="a00002.html#a8bad05ec0bc08aa74b2cbf13a7c9aac5">end</a>;
  }
  <span class="keywordflow">if</span> (bf-&gt;<a class="code" href="a00002.html#a8bad05ec0bc08aa74b2cbf13a7c9aac5">end</a> &lt;  bf-&gt;<a class="code" href="a00002.html#ad13dc2d65892a509ccd131031b401a91">start</a>) {
    bf-&gt;<a class="code" href="a00002.html#ad13dc2d65892a509ccd131031b401a91">start</a> = bf-&gt;<a class="code" href="a00002.html#a8bad05ec0bc08aa74b2cbf13a7c9aac5">end</a>; 
  }
  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="gaacf9d4de524e47e30360e243d39c0f73"></a><!-- doxytag: member="bf.h::BF_set_get" ref="gaacf9d4de524e47e30360e243d39c0f73" args="(BF *bf, size_t pos)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BF_set_get </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00002.html">BF</a> *&#160;</td>
          <td class="paramname"><em>bf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>pos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>set get position, position is relative to 'start' pointer. </p>

<p>Definition at line <a class="el" href="a00004_source.html#l00115">115</a> of file <a class="el" href="a00004_source.html">bf.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">size_t</span> bfs = bf-&gt;<a class="code" href="a00002.html#a8bad05ec0bc08aa74b2cbf13a7c9aac5">end</a> - bf-&gt;<a class="code" href="a00002.html#ad13dc2d65892a509ccd131031b401a91">start</a>; 
  <span class="keywordflow">if</span> (pos &gt; bfs) {
    <span class="keywordflow">return</span> -1;
  }
  bf-&gt;<a class="code" href="a00002.html#aa86484010e3b771e8dd1fe54cc8a0318">get_pos</a> = bf-&gt;<a class="code" href="a00002.html#ad13dc2d65892a509ccd131031b401a91">start</a> + pos;
  <span class="keywordflow">if</span> (bf-&gt;<a class="code" href="a00002.html#aa86484010e3b771e8dd1fe54cc8a0318">get_pos</a> &gt; bf-&gt;<a class="code" href="a00002.html#ac9b79e4f9d3b631ff510229a4e6bf778">put_pos</a>) {
     bf-&gt;<a class="code" href="a00002.html#ac9b79e4f9d3b631ff510229a4e6bf778">put_pos</a> = bf-&gt;<a class="code" href="a00002.html#aa86484010e3b771e8dd1fe54cc8a0318">get_pos</a>;
  }
  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ga3d4956583a84d460393dd68dca32f6ac"></a><!-- doxytag: member="bf.h::BF_set_put" ref="ga3d4956583a84d460393dd68dca32f6ac" args="(BF *bf, size_t pos)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BF_set_put </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00002.html">BF</a> *&#160;</td>
          <td class="paramname"><em>bf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>pos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>set put position, position is relative to 'start' pointer. </p>

<p>Definition at line <a class="el" href="a00004_source.html#l00128">128</a> of file <a class="el" href="a00004_source.html">bf.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">size_t</span> bfs = bf-&gt;<a class="code" href="a00002.html#a8bad05ec0bc08aa74b2cbf13a7c9aac5">end</a> - bf-&gt;<a class="code" href="a00002.html#ad13dc2d65892a509ccd131031b401a91">start</a>; 
  <span class="keywordflow">if</span> (pos &gt; bfs) {
    <span class="keywordflow">return</span> -1;
  }
  bf-&gt;<a class="code" href="a00002.html#ac9b79e4f9d3b631ff510229a4e6bf778">put_pos</a> = bf-&gt;<a class="code" href="a00002.html#ad13dc2d65892a509ccd131031b401a91">start</a> + pos;
  <span class="keywordflow">if</span> (bf-&gt;<a class="code" href="a00002.html#ac9b79e4f9d3b631ff510229a4e6bf778">put_pos</a> &lt; bf-&gt;<a class="code" href="a00002.html#aa86484010e3b771e8dd1fe54cc8a0318">get_pos</a>) {
     bf-&gt;<a class="code" href="a00002.html#aa86484010e3b771e8dd1fe54cc8a0318">get_pos</a> = bf-&gt;<a class="code" href="a00002.html#ac9b79e4f9d3b631ff510229a4e6bf778">put_pos</a>;
  }
  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ga18fdd2d33720298f25059429d226d9b2"></a><!-- doxytag: member="bf.h::BF_set_start" ref="ga18fdd2d33720298f25059429d226d9b2" args="(BF *bf, size_t pos)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BF_set_start </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00002.html">BF</a> *&#160;</td>
          <td class="paramname"><em>bf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>pos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>set start position, position is relative to start of memory range. </p>

<p>Definition at line <a class="el" href="a00004_source.html#l00077">77</a> of file <a class="el" href="a00004_source.html">bf.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> (pos &gt; bf-&gt;<a class="code" href="a00002.html#a709816af50943e6e155436fba2fc892c">bf_size</a>) {
    <span class="keywordflow">return</span> -1;
  }
  bf-&gt;<a class="code" href="a00002.html#ad13dc2d65892a509ccd131031b401a91">start</a> = bf-&gt;<a class="code" href="a00002.html#a8c4f938c3bda8c2f8c7642c285cd5d07">bf</a> + pos;

  <span class="keywordflow">if</span> (bf-&gt;<a class="code" href="a00002.html#ad13dc2d65892a509ccd131031b401a91">start</a> &gt; bf-&gt;<a class="code" href="a00002.html#aa86484010e3b771e8dd1fe54cc8a0318">get_pos</a>) {
     bf-&gt;<a class="code" href="a00002.html#aa86484010e3b771e8dd1fe54cc8a0318">get_pos</a> = bf-&gt;<a class="code" href="a00002.html#ad13dc2d65892a509ccd131031b401a91">start</a>;
  }
  <span class="keywordflow">if</span> (bf-&gt;<a class="code" href="a00002.html#ad13dc2d65892a509ccd131031b401a91">start</a> &gt; bf-&gt;<a class="code" href="a00002.html#ac9b79e4f9d3b631ff510229a4e6bf778">put_pos</a>) {
     bf-&gt;<a class="code" href="a00002.html#ac9b79e4f9d3b631ff510229a4e6bf778">put_pos</a> = bf-&gt;<a class="code" href="a00002.html#ad13dc2d65892a509ccd131031b401a91">start</a>;
  }
  <span class="keywordflow">if</span> (bf-&gt;<a class="code" href="a00002.html#ad13dc2d65892a509ccd131031b401a91">start</a> &gt; bf-&gt;<a class="code" href="a00002.html#a8bad05ec0bc08aa74b2cbf13a7c9aac5">end</a>) {
    bf-&gt;<a class="code" href="a00002.html#a8bad05ec0bc08aa74b2cbf13a7c9aac5">end</a> = bf-&gt;<a class="code" href="a00002.html#ad13dc2d65892a509ccd131031b401a91">start</a>; 
  }
  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Mon Sep 5 2011 13:24:29 for Simple tools for networking / objects in plain C by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
