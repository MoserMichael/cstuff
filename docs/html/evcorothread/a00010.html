<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Simple coroutine library integrated with IO event loop (libevent) / objects in plain C: EVTHREAD</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Simple coroutine library integrated with IO event loop (libevent) / objects in plain C&#160;<span id="projectnumber">Snapshot</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">EVTHREAD</div>  </div>
</div>
<div class="contents">

<p>user mode thread attached to an event loop The thread owns one or more EVSOCKETS, it initially activated when the thread is created, and is futher activated when an IO event occurs on a EVSOCKET object owned by this thread.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00003.html">tagEVTHREAD</a></td></tr>
<tr><td colspan="2"><h2><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00010.html#ga234cc8fab2090c3bf2314d41f23f66d5">EVTHREAD_PROC</a> )(struct <a class="el" href="a00003.html">tagEVTHREAD</a> *thread, struct <a class="el" href="a00002.html">tagEVSOCKET</a> *socket, void *user_ctx)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="a00003.html">tagEVTHREAD</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00010.html#gadbf6a6fe0e60307b58ee163176c1839a">EVTHREAD</a></td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00003.html">EVTHREAD</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00010.html#gaa23e69897b0c289d7da8f8d10435a140">EVTHREAD_init</a> (<a class="el" href="a00001.html">EVLOOP</a> *loop, <a class="el" href="a00010.html#ga234cc8fab2090c3bf2314d41f23f66d5">EVTHREAD_PROC</a> thread_proc, void *user_ctx)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00010.html#gad53dee62668086eb89016bb5b7e14fa5">EVTHREAD_start</a> (<a class="el" href="a00003.html">EVTHREAD</a> *thread, struct <a class="el" href="a00002.html">tagEVSOCKET</a> *socket)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00010.html#ga51f061f7921e0bbce68d3a16e043a0ff">EVTHREAD_delay</a> (<a class="el" href="a00003.html">EVTHREAD</a> *thread, struct timeval delay)</td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<p>user mode thread attached to an event loop The thread owns one or more EVSOCKETS, it initially activated when the thread is created, and is futher activated when an IO event occurs on a EVSOCKET object owned by this thread. </p>
<hr/><h2>Typedef Documentation</h2>
<a class="anchor" id="gadbf6a6fe0e60307b58ee163176c1839a"></a><!-- doxytag: member="evthread.h::EVTHREAD" ref="gadbf6a6fe0e60307b58ee163176c1839a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="a00003.html">tagEVTHREAD</a>  <a class="el" href="a00003.html">EVTHREAD</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ga234cc8fab2090c3bf2314d41f23f66d5"></a><!-- doxytag: member="evthread.h::EVTHREAD_PROC" ref="ga234cc8fab2090c3bf2314d41f23f66d5" args=")(struct tagEVTHREAD *thread, struct tagEVSOCKET *socket, void *user_ctx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* <a class="el" href="a00010.html#ga234cc8fab2090c3bf2314d41f23f66d5">EVTHREAD_PROC</a>)(struct <a class="el" href="a00003.html">tagEVTHREAD</a> *thread, struct <a class="el" href="a00002.html">tagEVSOCKET</a> *socket, void *user_ctx)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="a00008_source.html#l00069">69</a> of file <a class="el" href="a00008_source.html">evthread.h</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ga51f061f7921e0bbce68d3a16e043a0ff"></a><!-- doxytag: member="evthread.h::EVTHREAD_delay" ref="ga51f061f7921e0bbce68d3a16e043a0ff" args="(EVTHREAD *thread, struct timeval delay)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int EVTHREAD_delay </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00003.html">EVTHREAD</a> *&#160;</td>
          <td class="paramname"><em>thread</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct timeval&#160;</td>
          <td class="paramname"><em>delay</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="a00007_source.html#l00110">110</a> of file <a class="el" href="a00007_source.html">evthread.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  event_set( &amp;thread-&gt;<a class="code" href="a00003.html#acd108dfbd9acff91f9f19be88df46369">timer_event</a>, -1, 0, <a class="code" href="a00007.html#a205141cb4354a9ea6d692c30c0a62bd4">thread_timer_cb</a>, (<span class="keywordtype">void</span> *) thread );
  event_base_set( thread-&gt;<a class="code" href="a00003.html#abd1b6bd8c48500d617d9779fcac65cdc">loop</a>-&gt;<a class="code" href="a00001.html#a3ef46ca89266616a4ca06b62e60e8062">ev_base</a>, &amp;thread-&gt;<a class="code" href="a00003.html#acd108dfbd9acff91f9f19be88df46369">timer_event</a> );
  event_add( &amp;thread-&gt;<a class="code" href="a00003.html#acd108dfbd9acff91f9f19be88df46369">timer_event</a>, &amp;delay );
   
  CTHREAD_yield( 0, 0);
   
  event_del( &amp;thread-&gt;<a class="code" href="a00003.html#acd108dfbd9acff91f9f19be88df46369">timer_event</a> );

 
  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="gaa23e69897b0c289d7da8f8d10435a140"></a><!-- doxytag: member="evthread.h::EVTHREAD_init" ref="gaa23e69897b0c289d7da8f8d10435a140" args="(EVLOOP *loop, EVTHREAD_PROC thread_proc, void *user_ctx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00003.html">EVTHREAD</a>* EVTHREAD_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00001.html">EVLOOP</a> *&#160;</td>
          <td class="paramname"><em>loop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00010.html#ga234cc8fab2090c3bf2314d41f23f66d5">EVTHREAD_PROC</a>&#160;</td>
          <td class="paramname"><em>thread_proc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>user_ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="a00007_source.html#l00079">79</a> of file <a class="el" href="a00007_source.html">evthread.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="a00003.html">EVTHREAD</a> *thread;

  thread = (<a class="code" href="a00003.html">EVTHREAD</a> *) malloc( <span class="keyword">sizeof</span>( <a class="code" href="a00003.html">EVTHREAD</a> ) );
  <span class="keywordflow">if</span> (!thread) {
    <span class="keywordflow">return</span> 0;
  }
  thread-&gt;<a class="code" href="a00003.html#abd1b6bd8c48500d617d9779fcac65cdc">loop</a> = loop;
  thread-&gt;<a class="code" href="a00003.html#abb9ebfa4591c3e6538abe7aa8c7cc8ab">thread_proc</a> = thread_proc;
  thread-&gt;<a class="code" href="a00003.html#afc9604c7677fa92279f144561a816438">user_context</a> = user_ctx;

  thread-&gt;<a class="code" href="a00003.html#add57a915bbd0ab5ee1ba23f2f000ced6">cthread</a> = CTHREAD_init( loop-&gt;<a class="code" href="a00001.html#abc5af16a5c530aebd2015bbec8756a52">stacks</a>, <a class="code" href="a00007.html#abc55701105da0863845a6bf2212ac294">evthread_proc</a> );
  <span class="keywordflow">if</span> (!thread-&gt;<a class="code" href="a00003.html#add57a915bbd0ab5ee1ba23f2f000ced6">cthread</a>) {
    free(thread);
    <span class="keywordflow">return</span> 0;
  }
  thread-&gt;<a class="code" href="a00003.html#acbc4c1ff508c758eb16d77dc9729fd3a">socket</a> = 0;

  DLIST_init( &amp;thread-&gt;<a class="code" href="a00003.html#ab6d295983287160d97863ce19955cb34">object_list</a> );

  <span class="keywordflow">return</span> thread;
}
</pre></div>
</div>
</div>
<a class="anchor" id="gad53dee62668086eb89016bb5b7e14fa5"></a><!-- doxytag: member="evthread.h::EVTHREAD_start" ref="gad53dee62668086eb89016bb5b7e14fa5" args="(EVTHREAD *thread, struct tagEVSOCKET *socket)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int EVTHREAD_start </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00003.html">EVTHREAD</a> *&#160;</td>
          <td class="paramname"><em>thread</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="a00002.html">tagEVSOCKET</a> *&#160;</td>
          <td class="paramname"><em>socket</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="a00007_source.html#l00103">103</a> of file <a class="el" href="a00007_source.html">evthread.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  thread-&gt;<a class="code" href="a00003.html#acbc4c1ff508c758eb16d77dc9729fd3a">socket</a> = socket;
  CTHREAD_start( thread-&gt;<a class="code" href="a00003.html#add57a915bbd0ab5ee1ba23f2f000ced6">cthread</a>, 0, <span class="stringliteral">&quot;%p&quot;</span>, thread );
  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Oct 25 2011 00:52:50 for Simple coroutine library integrated with IO event loop (libevent) / objects in plain C by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
