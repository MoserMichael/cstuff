<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Simple coroutine library integrated with IO event loop (libevent) / objects in plain C: EVLOOP</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Simple coroutine library integrated with IO event loop (libevent) / objects in plain C&#160;<span id="projectnumber">Snapshot</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">EVLOOP</div>  </div>
</div>
<div class="contents">

<p>event loop object. The event loop wraps a small user mode threading library where a user mode thread is created per connection.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00001.html">tagEVLOOP</a></td></tr>
<tr><td colspan="2"><h2><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="a00001.html">tagEVLOOP</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00009.html#ga962e10cc0631184c27e12a42a78e2f38">EVLOOP</a></td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00001.html">EVLOOP</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00009.html#gac2c9758c338da8cf0bd5692db7547564">EVLOOP_init</a> (STACKS *stacks)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00009.html#gaa25fcfb07b6227a4749e2d148bb053b3">EVLOOP_run</a> (<a class="el" href="a00001.html">EVLOOP</a> *loop)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00009.html#ga6886f671cea83756af4d537b31c53436">EVLOOP_break</a> (<a class="el" href="a00001.html">EVLOOP</a> *loop)</td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<p>event loop object. The event loop wraps a small user mode threading library where a user mode thread is created per connection. </p>
<p>When a new connection is received via accept(2), then an EVSOCKET object is created that encapsulates this socket, and the socket is set to non blocking mode, and a user mode thread EVTHREAD is created that owns the new EVSOCKET object. TCPACCEPTOR is the class that does all that.</p>
<p>A user mode thread can own one or more EVSOCKET objects, it can read or write to an EVSOCKET object which has the API of a blocking socket. when the socket blocks, (i.e. recv or send returns -1 and errno == EWOULDBLOCK) then the attached user mode thread is suspended, and control returns to the event loop, the event loop schedules a different user mode thread, when an IO event occurs on a socket owned by that thread.</p>
<p>A user mode thread (EVTHREAD) can create other sockets (EVSOCKET) that are then attached to the current thread.</p>
<p>A use mode thread also owns a set of timer objects (EVTIMER), when the thread exits, all the timer objects are cleaned up.</p>
<p>The event loop is implemented by libevent.</p>
<p>Unlike other packages, where one can create several user mode thread and then has to cope with the problem of their synchronization, we keep things simple here. There is one thread per connection, that is supposed to do protocol handling and processing, all on condition that processing does not involve heavy CPU intensive tasks. If your problem does have such task, then there is also support for the Half-sync/Half-async pattern. </p>
<hr/><h2>Typedef Documentation</h2>
<a class="anchor" id="ga962e10cc0631184c27e12a42a78e2f38"></a><!-- doxytag: member="evthread.h::EVLOOP" ref="ga962e10cc0631184c27e12a42a78e2f38" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="a00001.html">tagEVLOOP</a>  <a class="el" href="a00001.html">EVLOOP</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ga6886f671cea83756af4d537b31c53436"></a><!-- doxytag: member="evthread.h::EVLOOP_break" ref="ga6886f671cea83756af4d537b31c53436" args="(EVLOOP *loop)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int EVLOOP_break </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00001.html">EVLOOP</a> *&#160;</td>
          <td class="paramname"><em>loop</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="a00007_source.html#l00038">38</a> of file <a class="el" href="a00007_source.html">evthread.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span>  event_base_loopbreak( loop-&gt;<a class="code" href="a00001.html#a3ef46ca89266616a4ca06b62e60e8062">ev_base</a> ); 
}
</pre></div>
</div>
</div>
<a class="anchor" id="gac2c9758c338da8cf0bd5692db7547564"></a><!-- doxytag: member="evthread.h::EVLOOP_init" ref="gac2c9758c338da8cf0bd5692db7547564" args="(STACKS *stacks)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00001.html">EVLOOP</a>* EVLOOP_init </td>
          <td>(</td>
          <td class="paramtype">STACKS *&#160;</td>
          <td class="paramname"><em>stacks</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="a00007_source.html#l00009">9</a> of file <a class="el" href="a00007_source.html">evthread.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="a00001.html">EVLOOP</a> *loop;

  loop = (<a class="code" href="a00001.html">EVLOOP</a> *)  malloc( <span class="keyword">sizeof</span>( <a class="code" href="a00001.html">EVLOOP</a> ) );
  <span class="keywordflow">if</span> (!loop) {
    <span class="keywordflow">return</span> 0;
  }

  <span class="keywordflow">if</span> (!stacks) {
    <span class="keywordflow">return</span> 0;
  }
  loop-&gt;<a class="code" href="a00001.html#abc5af16a5c530aebd2015bbec8756a52">stacks</a> = stacks;
 
  disable_sigpipe();

  loop-&gt;<a class="code" href="a00001.html#a3ef46ca89266616a4ca06b62e60e8062">ev_base</a> = event_init();
  <span class="keywordflow">if</span> (!loop-&gt;<a class="code" href="a00001.html#a3ef46ca89266616a4ca06b62e60e8062">ev_base</a>) {
    <span class="keywordflow">return</span> 0;
  }

  <span class="keywordflow">return</span> loop;
}
</pre></div>
</div>
</div>
<a class="anchor" id="gaa25fcfb07b6227a4749e2d148bb053b3"></a><!-- doxytag: member="evthread.h::EVLOOP_run" ref="gaa25fcfb07b6227a4749e2d148bb053b3" args="(EVLOOP *loop)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int EVLOOP_run </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00001.html">EVLOOP</a> *&#160;</td>
          <td class="paramname"><em>loop</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="a00007_source.html#l00033">33</a> of file <a class="el" href="a00007_source.html">evthread.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> event_base_dispatch( loop-&gt;<a class="code" href="a00001.html#a3ef46ca89266616a4ca06b62e60e8062">ev_base</a> );
}
</pre></div>
</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Sat Oct 1 2011 20:17:41 for Simple coroutine library integrated with IO event loop (libevent) / objects in plain C by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
