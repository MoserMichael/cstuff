<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>WEBBY - the embedded web server with many faces / objects in plain C: webby.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">WEBBY - the embedded web server with many faces / objects in plain C&#160;<span id="projectnumber">Snapshot</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Defines</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">webby.c File Reference</div>  </div>
</div>
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="a00017_source.html">webby.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="a00018_source.html">webbyimpl.h</a>&quot;</code><br/>
<code>#include &lt;hutils/http.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;cutils/properties.h&gt;</code><br/>
<code>#include &lt;butils/logg.h&gt;</code><br/>
</div>
<p><a href="a00016_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00012.html">tagVIRTUAL_HOST_DEFINITION</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00003.html">tagDATA_SINK_FILTER</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00004.html">tagDATA_SINK_FILTER_CONNECTION_CONTEXT</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00011.html">tagSERVLET_RUNNER_FILTER</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00002.html">SERVLET_FILTER_CONNECTION_CONTEXT</a></td></tr>
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00016.html#a44427928ad20e54e7cef524635ff2bc0">RESERVED_FOR_CHUNK_HEADER_SIZE</a>&#160;&#160;&#160;15</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00016.html#a7f05649123949a8e965870c97010f80e">LAST_CHUNK_NOT_FIRST</a>&#160;&#160;&#160;&quot;\r\n0\r\n\r\n&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00016.html#aab62a761d0efd5b816b635391ca69f8b">LAST_CHUNK_NOT_FIRST_SIZE</a>&#160;&#160;&#160;7</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00016.html#a62c1114c9b862ff891296691c7564ac7">LAST_CHUNK_FIRST</a>&#160;&#160;&#160;&quot;0\r\n\r\n&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00016.html#acb30928d1b99967ceedfadeebc124151">LAST_CHUNK_FIRST_SIZE</a>&#160;&#160;&#160;5</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00016.html#a2015bcbf6c5384890d22567bba40056d">HTTP_100_CONTINUE_RESPONSE</a>&#160;&#160;&#160;&quot;HTTP/1.1 100 Continue\r\n\r\n&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00016.html#a5847d13704437f4dddb4ef4671dabb7d">HTTP_100_CONTINUE_RESPONSE_LEN</a>&#160;&#160;&#160;25</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00016.html#a080daa68e2273c3375d0adb8a5a5c0ea">HTTP_400_BAD_REQUEST</a>&#160;&#160;&#160;&quot;HTTP/1.1 400 Bad Request\r\nContent-Length: 0\r\n\r\n&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00016.html#a3c18a0d90bc1c9f3b6d7a2d469c10570">HTTP_400_BAD_REQUEST_LEN</a>&#160;&#160;&#160;47</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00016.html#aa329368df498e3841e168fd0f2487ca9">HTTP_404_NOT_FOUND</a>&#160;&#160;&#160;&quot;HTTP/1.1 404 Not Found\r\nContent-Length: 0\r\n\r\n&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00016.html#ad1a3e36a0d6be4f97e74c772e17db0f6">HTTP_404_NOT_FOUND_LEN</a>&#160;&#160;&#160;45</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00016.html#a7c23b56c42f83405f572a89b1c562236">HTTP_500_SERVER_ERROR</a>&#160;&#160;&#160;&quot;HTTP/1.1 500 Internal Server Error\r\nContent-Length: 0\r\n\r\n&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00016.html#aeac2904b4dc3e9bc8665967226a7ad81">HTTP_500_SERVER_ERROR_LEN</a>&#160;&#160;&#160;57</td></tr>
<tr><td colspan="2"><h2><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <br class="typebreak"/>
<a class="el" href="a00012.html">tagVIRTUAL_HOST_DEFINITION</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00016.html#a1e17d3c1c46e17e456fab4b91dbbf0fd">VIRTUAL_HOST_DEFINITION</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="a00003.html">tagDATA_SINK_FILTER</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00016.html#a1ceda15a8ef21d62a0457293b06bc420">DATA_SINK_FILTER</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <br class="typebreak"/>
<a class="el" href="a00004.html">tagDATA_SINK_FILTER_CONNECTION_CONTEXT</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00016.html#a6d897d88574b6ae75f3f0fb87acd1623">DATA_SINK_FILTER_CONNECTION_CONTEXT</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <br class="typebreak"/>
<a class="el" href="a00011.html">tagSERVLET_RUNNER_FILTER</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00016.html#a143da2e07bf95015273943862a69602d">SERVLET_RUNNER_FILTER</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <br class="typebreak"/>
<a class="el" href="a00002.html">SERVLET_FILTER_CONNECTION_CONTEXT</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00016.html#a3f314cfd2eb6f901764100ea0e403564">SERVLET_FILTER_CONNECTION_CONTEXT</a></td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00004.html">DATA_SINK_FILTER_CONNECTION_CONTEXT</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00016.html#aa55c83fd7a299c138c538b20d50e9cb2">DATA_SINK_FILTER_CONNECTION_CONTEXT_init</a> (void *impl_connection_ctx, BF *out_buf)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00016.html#a3213ef672b34bbb957fb0650ff5b2c85">DATA_SINK_FILTER_CONNECTION_CONTEXT_free</a> (<a class="el" href="a00004.html">DATA_SINK_FILTER_CONNECTION_CONTEXT</a> *ctx)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00016.html#a601da19b20c63ad3bb7ba3a16916b7f0">sink_req_header_parsed</a> (HTTP_REQUEST *request, <a class="el" href="a00005.html">FILTER_CONTEXT</a> *context)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00016.html#adda20398a8edb8125382ba5001294e58">sink_req_data</a> (HTTP_REQUEST *request, void *data, size_t data_size, <a class="el" href="a00005.html">FILTER_CONTEXT</a> *context)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00016.html#a490c00eaaa1279aa373aa08b63ed572e">sink_req_completed</a> (HTTP_REQUEST *request, <a class="el" href="a00005.html">FILTER_CONTEXT</a> *context)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00016.html#a4e52cf5f68c18c32dcad138f7f444a09">sink_on_response_header</a> (HTTP_RESPONSE *response, <a class="el" href="a00005.html">FILTER_CONTEXT</a> *context)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00016.html#a2579884d18879e342c318b215e40e8dc">sink_on_response_data</a> (HTTP_RESPONSE *response, int is_chunk, <a class="el" href="a00001.html">RDATA</a> rdata, <a class="el" href="a00005.html">FILTER_CONTEXT</a> *context)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00016.html#aa71d1b94a4004acfa1d58c9535bea773">sink_on_response_complete</a> (HTTP_RESPONSE *response, <a class="el" href="a00005.html">FILTER_CONTEXT</a> *context)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00016.html#af77c4d76ab2670314f249617de68fd5d">sink_connection_close</a> (<a class="el" href="a00005.html">FILTER_CONTEXT</a> *context)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00003.html">DATA_SINK_FILTER</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00016.html#ae2c4f415dacbb1559c04a802a1b1ea85">DATA_SINK_FILTER_init</a> (<a class="el" href="a00013.html">WEBBY</a> *server)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00016.html#a06f7aefbd60aee0524ea808d92fe7ae2">DATA_SINK_FILTER_add_vhost</a> (<a class="el" href="a00003.html">DATA_SINK_FILTER</a> *vhost_filter, const char *host, int port_num, size_t *vhost_idx)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00016.html#a8ee2b58fd7b17a9b1c7a79f14f27f9cb">DATA_SINK_FILTER_add_filter_to_vhost</a> (<a class="el" href="a00003.html">DATA_SINK_FILTER</a> *vhost_filter, size_t vhost_idx, <a class="el" href="a00006.html">HTTP_FILTER</a> *new_filter)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00002.html">SERVLET_FILTER_CONNECTION_CONTEXT</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00016.html#a4f9df4e8f2785ac8500896ec74d4de09">SERVLET_FILTER_CONNECTION_CONTEXT_init</a> (<a class="el" href="a00011.html">SERVLET_RUNNER_FILTER</a> *rfilter)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00016.html#a7d1a1a1862eeb63a0a4f4b7bcc0152c7">servlets_req_header_parsed</a> (HTTP_REQUEST *request, <a class="el" href="a00005.html">FILTER_CONTEXT</a> *context)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00016.html#a223c0d62cecfa47dcbf0e083b720ffd7">servlets_req_on_message_data</a> (HTTP_REQUEST *request, void *data, size_t data_size, <a class="el" href="a00005.html">FILTER_CONTEXT</a> *context)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00016.html#ad84e5be2ed54a5e98bc4c82fd8768926">servlets_req_finished</a> (HTTP_REQUEST *request, <a class="el" href="a00005.html">FILTER_CONTEXT</a> *context)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00016.html#a0dfe75c88868c24edd8f7fb1d1dea130">servlets_connection_close</a> (<a class="el" href="a00005.html">FILTER_CONTEXT</a> *context)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00011.html">SERVLET_RUNNER_FILTER</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00016.html#ae2e8a500699c277f9d7461f75e15c517">SERVLET_RUNNER_FILTER_init</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00016.html#a21cf1ef43e78be908c81fca4e40b539b">SERVLET_RUNNER_FILTER_free</a> (<a class="el" href="a00011.html">SERVLET_RUNNER_FILTER</a> *servlets)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00016.html#a86c88fca79c44bdc017513e1c03dc45d">SERVLET_RUNNER_FILTER_add_servlet</a> (<a class="el" href="a00011.html">SERVLET_RUNNER_FILTER</a> *servlets, <a class="el" href="a00007.html">HTTP_SERVLET</a> *servlet)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00023.html#ga107523da95cf41a0ff405131f32277cc">WEBBY_CONFIG_load</a> (<a class="el" href="a00014.html">WEBBY_CONFIG</a> *cfg, const char *file)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00013.html">WEBBY</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00024.html#ga24e0938463669691db76aa3a2aba418e">WEBBY_init</a> (<a class="el" href="a00014.html">WEBBY_CONFIG</a> *cfg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00024.html#ga294920c6df652655a63a9cd5c368a09f">WEBBY_add_vhost</a> (<a class="el" href="a00013.html">WEBBY</a> *server, const char *host, int port_num, size_t *vhost_idx)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00024.html#ga63d8c8d948713ccf37e92513e926d8b5">WEBBY_add_filter</a> (<a class="el" href="a00013.html">WEBBY</a> *server, size_t vhost_idx, <a class="el" href="a00006.html">HTTP_FILTER</a> *filter)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00024.html#ga6bcdf0577f33a202169d2df9fb2f782d">WEBBY_add_servlet</a> (<a class="el" href="a00013.html">WEBBY</a> *server, <a class="el" href="a00007.html">HTTP_SERVLET</a> *servlet)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00024.html#gad219e92389c7104756b0955e39f395a8">WEBBY_run</a> (<a class="el" href="a00013.html">WEBBY</a> *server)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00024.html#ga2fff1941b52b1eba9ded25079ecc3c6a">WEBBY_shutdown</a> (<a class="el" href="a00013.html">WEBBY</a> *server)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00016.html#a5d270f92a2a1d91a4497f7619892c421">http_header_parsed</a> (HTTP_REQUEST *request, void *ctx)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00016.html#a14b4ca97d7155383d1a5c97a27bb4944">http_on_message_data</a> (HTTP_REQUEST *request, void *data, size_t data_size, void *ctx)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00016.html#ada6754658cfa8e6ac72c2f81497ea618">http_req_finished</a> (HTTP_REQUEST *request, void *ctx)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00015.html">WEBBY_CONNECTION</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00024.html#ga468f7c2a048c111edea76276865b0f11">WEBBY_new_connection</a> (<a class="el" href="a00013.html">WEBBY</a> *server, void *implconndata)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00024.html#ga80d94011f2e61e29fd041437c6dbdf17">WEBBY_connection_data_received</a> (<a class="el" href="a00015.html">WEBBY_CONNECTION</a> *connection)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00024.html#ga000431a1b99da08f5711e788533ce0e2">WEBBY_connection_close</a> (<a class="el" href="a00015.html">WEBBY_CONNECTION</a> *connection)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00022.html#ga520d40a9fe92a4764f7800a957e74f35">HTTP_response_start</a> (<a class="el" href="a00009.html">HTTP_servlet_response</a> *resp, int status, const char *mime_type, <a class="el" href="a00022.html#gacac342618d827f10f920dd5d548967ef">HTTP_servlet_response_type</a> rtype, size_t length)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">initiate an HTTP response  <a href="a00022.html#ga520d40a9fe92a4764f7800a957e74f35"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00022.html#gaed8f8e393fd1515d2f544f590c6b1867">HTTP_response_send</a> (<a class="el" href="a00009.html">HTTP_servlet_response</a> *resp, void *data, size_t size)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">send response data when sending RESPONSE_CONTENT_LENGTH or RESPONSE_CONNECTION_CLOSE responses  <a href="a00022.html#gaed8f8e393fd1515d2f544f590c6b1867"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">BF *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00022.html#gac35744637829527c41116ff45b67db37">HTTP_response_get_chunk_buffer</a> (<a class="el" href="a00009.html">HTTP_servlet_response</a> *resp, size_t chunk_size)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">returns buffer for sending chunks The buffer reserves enough space before start of buffer, in order to allow addition of chunk header before the sent daa  <a href="a00022.html#gac35744637829527c41116ff45b67db37"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00022.html#gaba723292382fdd7307c5bd25a0370fe5">HTTP_response_write_chunk</a> (<a class="el" href="a00009.html">HTTP_servlet_response</a> *resp, BF *bf)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">send chunk from buffer The buffer must reserve enough space for the chunk header, before start of buffer  <a href="a00022.html#gaba723292382fdd7307c5bd25a0370fe5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00022.html#gafcfed03fea048f6eab98c8b410bcc52c">HTTP_response_finish</a> (<a class="el" href="a00009.html">HTTP_servlet_response</a> *resp)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">finish sending of response  <a href="a00022.html#gafcfed03fea048f6eab98c8b410bcc52c"></a><br/></td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a2015bcbf6c5384890d22567bba40056d"></a><!-- doxytag: member="webby.c::HTTP_100_CONTINUE_RESPONSE" ref="a2015bcbf6c5384890d22567bba40056d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HTTP_100_CONTINUE_RESPONSE&#160;&#160;&#160;&quot;HTTP/1.1 100 Continue\r\n\r\n&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="a00016_source.html#l00019">19</a> of file <a class="el" href="a00016_source.html">webby.c</a>.</p>

</div>
</div>
<a class="anchor" id="a5847d13704437f4dddb4ef4671dabb7d"></a><!-- doxytag: member="webby.c::HTTP_100_CONTINUE_RESPONSE_LEN" ref="a5847d13704437f4dddb4ef4671dabb7d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HTTP_100_CONTINUE_RESPONSE_LEN&#160;&#160;&#160;25</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="a00016_source.html#l00020">20</a> of file <a class="el" href="a00016_source.html">webby.c</a>.</p>

</div>
</div>
<a class="anchor" id="a080daa68e2273c3375d0adb8a5a5c0ea"></a><!-- doxytag: member="webby.c::HTTP_400_BAD_REQUEST" ref="a080daa68e2273c3375d0adb8a5a5c0ea" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HTTP_400_BAD_REQUEST&#160;&#160;&#160;&quot;HTTP/1.1 400 Bad Request\r\nContent-Length: 0\r\n\r\n&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="a00016_source.html#l00022">22</a> of file <a class="el" href="a00016_source.html">webby.c</a>.</p>

</div>
</div>
<a class="anchor" id="a3c18a0d90bc1c9f3b6d7a2d469c10570"></a><!-- doxytag: member="webby.c::HTTP_400_BAD_REQUEST_LEN" ref="a3c18a0d90bc1c9f3b6d7a2d469c10570" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HTTP_400_BAD_REQUEST_LEN&#160;&#160;&#160;47</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="a00016_source.html#l00023">23</a> of file <a class="el" href="a00016_source.html">webby.c</a>.</p>

</div>
</div>
<a class="anchor" id="aa329368df498e3841e168fd0f2487ca9"></a><!-- doxytag: member="webby.c::HTTP_404_NOT_FOUND" ref="aa329368df498e3841e168fd0f2487ca9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HTTP_404_NOT_FOUND&#160;&#160;&#160;&quot;HTTP/1.1 404 Not Found\r\nContent-Length: 0\r\n\r\n&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="a00016_source.html#l00025">25</a> of file <a class="el" href="a00016_source.html">webby.c</a>.</p>

</div>
</div>
<a class="anchor" id="ad1a3e36a0d6be4f97e74c772e17db0f6"></a><!-- doxytag: member="webby.c::HTTP_404_NOT_FOUND_LEN" ref="ad1a3e36a0d6be4f97e74c772e17db0f6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HTTP_404_NOT_FOUND_LEN&#160;&#160;&#160;45</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="a00016_source.html#l00026">26</a> of file <a class="el" href="a00016_source.html">webby.c</a>.</p>

</div>
</div>
<a class="anchor" id="a7c23b56c42f83405f572a89b1c562236"></a><!-- doxytag: member="webby.c::HTTP_500_SERVER_ERROR" ref="a7c23b56c42f83405f572a89b1c562236" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HTTP_500_SERVER_ERROR&#160;&#160;&#160;&quot;HTTP/1.1 500 Internal Server Error\r\nContent-Length: 0\r\n\r\n&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="a00016_source.html#l00028">28</a> of file <a class="el" href="a00016_source.html">webby.c</a>.</p>

</div>
</div>
<a class="anchor" id="aeac2904b4dc3e9bc8665967226a7ad81"></a><!-- doxytag: member="webby.c::HTTP_500_SERVER_ERROR_LEN" ref="aeac2904b4dc3e9bc8665967226a7ad81" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HTTP_500_SERVER_ERROR_LEN&#160;&#160;&#160;57</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="a00016_source.html#l00029">29</a> of file <a class="el" href="a00016_source.html">webby.c</a>.</p>

</div>
</div>
<a class="anchor" id="a62c1114c9b862ff891296691c7564ac7"></a><!-- doxytag: member="webby.c::LAST_CHUNK_FIRST" ref="a62c1114c9b862ff891296691c7564ac7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LAST_CHUNK_FIRST&#160;&#160;&#160;&quot;0\r\n\r\n&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="a00016_source.html#l00016">16</a> of file <a class="el" href="a00016_source.html">webby.c</a>.</p>

</div>
</div>
<a class="anchor" id="acb30928d1b99967ceedfadeebc124151"></a><!-- doxytag: member="webby.c::LAST_CHUNK_FIRST_SIZE" ref="acb30928d1b99967ceedfadeebc124151" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LAST_CHUNK_FIRST_SIZE&#160;&#160;&#160;5</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="a00016_source.html#l00017">17</a> of file <a class="el" href="a00016_source.html">webby.c</a>.</p>

</div>
</div>
<a class="anchor" id="a7f05649123949a8e965870c97010f80e"></a><!-- doxytag: member="webby.c::LAST_CHUNK_NOT_FIRST" ref="a7f05649123949a8e965870c97010f80e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LAST_CHUNK_NOT_FIRST&#160;&#160;&#160;&quot;\r\n0\r\n\r\n&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="a00016_source.html#l00013">13</a> of file <a class="el" href="a00016_source.html">webby.c</a>.</p>

</div>
</div>
<a class="anchor" id="aab62a761d0efd5b816b635391ca69f8b"></a><!-- doxytag: member="webby.c::LAST_CHUNK_NOT_FIRST_SIZE" ref="aab62a761d0efd5b816b635391ca69f8b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LAST_CHUNK_NOT_FIRST_SIZE&#160;&#160;&#160;7</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="a00016_source.html#l00014">14</a> of file <a class="el" href="a00016_source.html">webby.c</a>.</p>

</div>
</div>
<a class="anchor" id="a44427928ad20e54e7cef524635ff2bc0"></a><!-- doxytag: member="webby.c::RESERVED_FOR_CHUNK_HEADER_SIZE" ref="a44427928ad20e54e7cef524635ff2bc0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RESERVED_FOR_CHUNK_HEADER_SIZE&#160;&#160;&#160;15</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="a00016_source.html#l00011">11</a> of file <a class="el" href="a00016_source.html">webby.c</a>.</p>

</div>
</div>
<hr/><h2>Typedef Documentation</h2>
<a class="anchor" id="a1ceda15a8ef21d62a0457293b06bc420"></a><!-- doxytag: member="webby.c::DATA_SINK_FILTER" ref="a1ceda15a8ef21d62a0457293b06bc420" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="a00003.html">tagDATA_SINK_FILTER</a>  <a class="el" href="a00003.html">DATA_SINK_FILTER</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a6d897d88574b6ae75f3f0fb87acd1623"></a><!-- doxytag: member="webby.c::DATA_SINK_FILTER_CONNECTION_CONTEXT" ref="a6d897d88574b6ae75f3f0fb87acd1623" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="a00004.html">tagDATA_SINK_FILTER_CONNECTION_CONTEXT</a>  <a class="el" href="a00004.html">DATA_SINK_FILTER_CONNECTION_CONTEXT</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a3f314cfd2eb6f901764100ea0e403564"></a><!-- doxytag: member="webby.c::SERVLET_FILTER_CONNECTION_CONTEXT" ref="a3f314cfd2eb6f901764100ea0e403564" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="a00002.html">SERVLET_FILTER_CONNECTION_CONTEXT</a>  <a class="el" href="a00002.html">SERVLET_FILTER_CONNECTION_CONTEXT</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a143da2e07bf95015273943862a69602d"></a><!-- doxytag: member="webby.c::SERVLET_RUNNER_FILTER" ref="a143da2e07bf95015273943862a69602d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="a00011.html">tagSERVLET_RUNNER_FILTER</a>  <a class="el" href="a00011.html">SERVLET_RUNNER_FILTER</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a1e17d3c1c46e17e456fab4b91dbbf0fd"></a><!-- doxytag: member="webby.c::VIRTUAL_HOST_DEFINITION" ref="a1e17d3c1c46e17e456fab4b91dbbf0fd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="a00012.html">tagVIRTUAL_HOST_DEFINITION</a>  <a class="el" href="a00012.html">VIRTUAL_HOST_DEFINITION</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a8ee2b58fd7b17a9b1c7a79f14f27f9cb"></a><!-- doxytag: member="webby.c::DATA_SINK_FILTER_add_filter_to_vhost" ref="a8ee2b58fd7b17a9b1c7a79f14f27f9cb" args="(DATA_SINK_FILTER *vhost_filter, size_t vhost_idx, HTTP_FILTER *new_filter)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int DATA_SINK_FILTER_add_filter_to_vhost </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00003.html">DATA_SINK_FILTER</a> *&#160;</td>
          <td class="paramname"><em>vhost_filter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>vhost_idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00006.html">HTTP_FILTER</a> *&#160;</td>
          <td class="paramname"><em>new_filter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="a00016_source.html#l00313">313</a> of file <a class="el" href="a00016_source.html">webby.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">size_t</span> filter_idx;
  <a class="code" href="a00012.html">VIRTUAL_HOST_DEFINITION</a>  *vhost; 
  <a class="code" href="a00006.html" title="http filter definition">HTTP_FILTER</a> *last_filter;
  <a class="code" href="a00006.html" title="http filter definition">HTTP_FILTER</a> **tmp;
  <span class="keywordtype">int</span> is_default_vhost;

  <span class="comment">// get virtual host defnition</span>
  <span class="keywordflow">if</span> (ARRAY_size( &amp;vhost_filter-&gt;<a class="code" href="a00003.html#a9c6f8e0600fbd38e03b0538b0407c3f0">vhosts</a> ) == 0) {
    vhost = &amp;vhost_filter-&gt;<a class="code" href="a00003.html#a2c0b9e3c6b8d7ab4e32b39247d785c9c">default_vhost</a>; 
    is_default_vhost = 1;
  } <span class="keywordflow">else</span> {
    vhost = (<a class="code" href="a00012.html">VIRTUAL_HOST_DEFINITION</a>  *) ARRAY_at( &amp;vhost_filter-&gt;<a class="code" href="a00003.html#a9c6f8e0600fbd38e03b0538b0407c3f0">vhosts</a>, vhost_idx );
    is_default_vhost = 0;
  }
  <span class="keywordflow">if</span> (!vhost) {
    <span class="keywordflow">return</span> -1;
  }

  <span class="comment">// insert the new filter</span>
  <span class="keywordflow">if</span> (ARRAY_push_back( &amp;vhost_filter-&gt;<a class="code" href="a00003.html#a66f3bc5acdb299a761b3a4e163636ba6">server</a>-&gt;<a class="code" href="a00013.html#a8f09ca4fc1921b78808787b500de0431">filters</a>, &amp;new_filter, <span class="keyword">sizeof</span>(<span class="keywordtype">void</span> *) ) ) {
    <span class="keywordflow">return</span> -1;
  }
  filter_idx = ARRAY_size( &amp;vhost_filter-&gt;<a class="code" href="a00003.html#a66f3bc5acdb299a761b3a4e163636ba6">server</a>-&gt;<a class="code" href="a00013.html#a8f09ca4fc1921b78808787b500de0431">filters</a> ) - 1;  


  <span class="comment">// update virtual host filter chain.</span>
  <span class="keywordflow">if</span> (vhost-&gt;<a class="code" href="a00012.html#a765532c34c7267a755f02fc24f31461c">next_filter_idx</a> == (<span class="keywordtype">size_t</span>) -1) {
    vhost-&gt;<a class="code" href="a00012.html#a765532c34c7267a755f02fc24f31461c">next_filter_idx</a> = filter_idx;
    vhost-&gt;<a class="code" href="a00012.html#ad85ba3100f4e65d70573fea4d748441e">last_filter_idx</a> = filter_idx;

    new_filter-&gt;<a class="code" href="a00006.html#a2d64a2f372cb2f22ecc8fdfa53c0e3d7">next_request_filter_idx</a> = (size_t) -1;  ;
    new_filter-&gt;<a class="code" href="a00006.html#a39dbd3ce3cfb65108dfcdc963edc8a85">next_response_filter_idx</a> = 0;
 
    <span class="keywordflow">if</span> (is_default_vhost) {
      vhost_filter-&gt;<a class="code" href="a00003.html#aa8c43a02047472cd0e6d2b22cb9cfcba">base</a>.<a class="code" href="a00006.html#a2d64a2f372cb2f22ecc8fdfa53c0e3d7">next_request_filter_idx</a> = filter_idx;
      vhost_filter-&gt;<a class="code" href="a00003.html#aa8c43a02047472cd0e6d2b22cb9cfcba">base</a>.<a class="code" href="a00006.html#a39dbd3ce3cfb65108dfcdc963edc8a85">next_response_filter_idx</a> = (size_t) -1;
    }
  } <span class="keywordflow">else</span> {
    new_filter-&gt;<a class="code" href="a00006.html#a39dbd3ce3cfb65108dfcdc963edc8a85">next_response_filter_idx</a> =  vhost-&gt;<a class="code" href="a00012.html#ad85ba3100f4e65d70573fea4d748441e">last_filter_idx</a>;
    new_filter-&gt;<a class="code" href="a00006.html#a2d64a2f372cb2f22ecc8fdfa53c0e3d7">next_request_filter_idx</a> = (size_t) -1; 
    
    tmp = (<a class="code" href="a00006.html" title="http filter definition">HTTP_FILTER</a> **) ARRAY_at( &amp;vhost_filter-&gt;<a class="code" href="a00003.html#a66f3bc5acdb299a761b3a4e163636ba6">server</a>-&gt;<a class="code" href="a00013.html#a8f09ca4fc1921b78808787b500de0431">filters</a>, vhost-&gt;<a class="code" href="a00012.html#a765532c34c7267a755f02fc24f31461c">next_filter_idx</a> );
    last_filter = *tmp;
    last_filter-&gt;<a class="code" href="a00006.html#a2d64a2f372cb2f22ecc8fdfa53c0e3d7">next_request_filter_idx</a> = filter_idx;

    vhost-&gt;<a class="code" href="a00012.html#ad85ba3100f4e65d70573fea4d748441e">last_filter_idx</a> = filter_idx;
  }
  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a06f7aefbd60aee0524ea808d92fe7ae2"></a><!-- doxytag: member="webby.c::DATA_SINK_FILTER_add_vhost" ref="a06f7aefbd60aee0524ea808d92fe7ae2" args="(DATA_SINK_FILTER *vhost_filter, const char *host, int port_num, size_t *vhost_idx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int DATA_SINK_FILTER_add_vhost </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00003.html">DATA_SINK_FILTER</a> *&#160;</td>
          <td class="paramname"><em>vhost_filter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>host</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>port_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>vhost_idx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="a00016_source.html#l00297">297</a> of file <a class="el" href="a00016_source.html">webby.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="a00012.html">VIRTUAL_HOST_DEFINITION</a> def;

  def.<a class="code" href="a00012.html#a9a11ee99cbd8cbb85c822bab961e51fa">host</a> = strdup(host);
  def.<a class="code" href="a00012.html#a7e6172f0c4d87cfc3692d85b7a03ebaa">host_port</a> = port_num;
  def.<a class="code" href="a00012.html#a765532c34c7267a755f02fc24f31461c">next_filter_idx</a> = def.<a class="code" href="a00012.html#ad85ba3100f4e65d70573fea4d748441e">last_filter_idx</a> = (size_t) -1;
 
  *vhost_idx = ARRAY_size( &amp;vhost_filter-&gt;<a class="code" href="a00003.html#a9c6f8e0600fbd38e03b0538b0407c3f0">vhosts</a> ) ;

  <span class="keywordflow">if</span> ( ARRAY_push_back( &amp;vhost_filter-&gt;<a class="code" href="a00003.html#a9c6f8e0600fbd38e03b0538b0407c3f0">vhosts</a>, &amp;def, <span class="keyword">sizeof</span>( <a class="code" href="a00012.html">VIRTUAL_HOST_DEFINITION</a> ) ) )  {
    <span class="keywordflow">return</span> -1;
  }
  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a3213ef672b34bbb957fb0650ff5b2c85"></a><!-- doxytag: member="webby.c::DATA_SINK_FILTER_CONNECTION_CONTEXT_free" ref="a3213ef672b34bbb957fb0650ff5b2c85" args="(DATA_SINK_FILTER_CONNECTION_CONTEXT *ctx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DATA_SINK_FILTER_CONNECTION_CONTEXT_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00004.html">DATA_SINK_FILTER_CONNECTION_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="a00016_source.html#l00076">76</a> of file <a class="el" href="a00016_source.html">webby.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  free(ctx);
}
</pre></div>
</div>
</div>
<a class="anchor" id="aa55c83fd7a299c138c538b20d50e9cb2"></a><!-- doxytag: member="webby.c::DATA_SINK_FILTER_CONNECTION_CONTEXT_init" ref="aa55c83fd7a299c138c538b20d50e9cb2" args="(void *impl_connection_ctx, BF *out_buf)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00004.html">DATA_SINK_FILTER_CONNECTION_CONTEXT</a>* DATA_SINK_FILTER_CONNECTION_CONTEXT_init </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>impl_connection_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BF *&#160;</td>
          <td class="paramname"><em>out_buf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="a00016_source.html#l00061">61</a> of file <a class="el" href="a00016_source.html">webby.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="a00004.html">DATA_SINK_FILTER_CONNECTION_CONTEXT</a> *ret; 

  ret = (<a class="code" href="a00004.html">DATA_SINK_FILTER_CONNECTION_CONTEXT</a> *) malloc( <span class="keyword">sizeof</span>( <a class="code" href="a00004.html">DATA_SINK_FILTER_CONNECTION_CONTEXT</a> ) );
  <span class="keywordflow">if</span> (!ret) {
    <span class="keywordflow">return</span> 0;
  }
  ret-&gt;<a class="code" href="a00004.html#a21ea3e61a86610196315cefee2f71897">impl_connection_ctx</a> = impl_connection_ctx; 
  ret-&gt;<a class="code" href="a00004.html#af3a9d3d154e3d743999c45d4d3ea9714">out_buf</a> = out_buf;
  ret-&gt;<a class="code" href="a00004.html#a90a9c5702903bcb1f94632ecf6c8828e">next_request_filter</a> = (size_t) -1;

  <span class="keywordflow">return</span> ret;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ae2c4f415dacbb1559c04a802a1b1ea85"></a><!-- doxytag: member="webby.c::DATA_SINK_FILTER_init" ref="ae2c4f415dacbb1559c04a802a1b1ea85" args="(WEBBY *server)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00003.html">DATA_SINK_FILTER</a>* DATA_SINK_FILTER_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00013.html">WEBBY</a> *&#160;</td>
          <td class="paramname"><em>server</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="a00016_source.html#l00268">268</a> of file <a class="el" href="a00016_source.html">webby.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="a00003.html">DATA_SINK_FILTER</a> * ret;

  ret =  (<a class="code" href="a00003.html">DATA_SINK_FILTER</a> *) malloc( <span class="keyword">sizeof</span>( <a class="code" href="a00003.html">DATA_SINK_FILTER</a> ) );
  <span class="keywordflow">if</span> (!ret) {
    <span class="keywordflow">return</span> 0;
  }

  ret-&gt;<a class="code" href="a00003.html#aa8c43a02047472cd0e6d2b22cb9cfcba">base</a>.<a class="code" href="a00006.html#a680109fd10e4d352a38426fb3832154d">on_request_header_parsed</a> = <a class="code" href="a00016.html#a601da19b20c63ad3bb7ba3a16916b7f0">sink_req_header_parsed</a>;
  ret-&gt;<a class="code" href="a00003.html#aa8c43a02047472cd0e6d2b22cb9cfcba">base</a>.<a class="code" href="a00006.html#a6acb030789968d9a75fb32f3305c7a3c">on_request_data</a> = <a class="code" href="a00016.html#adda20398a8edb8125382ba5001294e58">sink_req_data</a>;
  ret-&gt;<a class="code" href="a00003.html#aa8c43a02047472cd0e6d2b22cb9cfcba">base</a>.<a class="code" href="a00006.html#ac171b2bcad117337da86aa482089ca8e">on_request_completed</a> = <a class="code" href="a00016.html#a490c00eaaa1279aa373aa08b63ed572e">sink_req_completed</a>;
  ret-&gt;<a class="code" href="a00003.html#aa8c43a02047472cd0e6d2b22cb9cfcba">base</a>.<a class="code" href="a00006.html#a9e06479f6878202fa0b7c47adeed5030">on_response_header</a> =  <a class="code" href="a00016.html#a4e52cf5f68c18c32dcad138f7f444a09">sink_on_response_header</a>; 
  ret-&gt;<a class="code" href="a00003.html#aa8c43a02047472cd0e6d2b22cb9cfcba">base</a>.<a class="code" href="a00006.html#a7505d786cec72de0641211b0da6b5b75">on_response_data</a> = <a class="code" href="a00016.html#a2579884d18879e342c318b215e40e8dc">sink_on_response_data</a>;   
  ret-&gt;<a class="code" href="a00003.html#aa8c43a02047472cd0e6d2b22cb9cfcba">base</a>.<a class="code" href="a00006.html#a68eb80c5a6751584f37e7c57bea85798">on_response_completed</a> = <a class="code" href="a00016.html#aa71d1b94a4004acfa1d58c9535bea773">sink_on_response_complete</a>;  
  ret-&gt;<a class="code" href="a00003.html#aa8c43a02047472cd0e6d2b22cb9cfcba">base</a>.<a class="code" href="a00006.html#a4e7c8380d5073fb0596d2ac4950c309f">on_connection_close</a> = <a class="code" href="a00016.html#af77c4d76ab2670314f249617de68fd5d">sink_connection_close</a>;

  ret-&gt;<a class="code" href="a00003.html#a66f3bc5acdb299a761b3a4e163636ba6">server</a> = server;
 
  memset( &amp;ret-&gt;<a class="code" href="a00003.html#a2c0b9e3c6b8d7ab4e32b39247d785c9c">default_vhost</a>, 0, <span class="keyword">sizeof</span>( <a class="code" href="a00012.html">VIRTUAL_HOST_DEFINITION</a> ) );
  ret-&gt;<a class="code" href="a00003.html#a2c0b9e3c6b8d7ab4e32b39247d785c9c">default_vhost</a>.<a class="code" href="a00012.html#a765532c34c7267a755f02fc24f31461c">next_filter_idx</a> = ret-&gt;<a class="code" href="a00003.html#a2c0b9e3c6b8d7ab4e32b39247d785c9c">default_vhost</a>.<a class="code" href="a00012.html#ad85ba3100f4e65d70573fea4d748441e">last_filter_idx</a> = (size_t) -1;
  
  <span class="keywordflow">if</span> (ARRAY_init( &amp;ret-&gt;<a class="code" href="a00003.html#a9c6f8e0600fbd38e03b0538b0407c3f0">vhosts</a>, <span class="keyword">sizeof</span>( <a class="code" href="a00012.html">VIRTUAL_HOST_DEFINITION</a> ), 10 )) {
    <span class="keywordflow">return</span> 0;
  }

  <span class="keywordflow">return</span> ret;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a5d270f92a2a1d91a4497f7619892c421"></a><!-- doxytag: member="webby.c::http_header_parsed" ref="a5d270f92a2a1d91a4497f7619892c421" args="(HTTP_REQUEST *request, void *ctx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int http_header_parsed </td>
          <td>(</td>
          <td class="paramtype">HTTP_REQUEST *&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="a00016_source.html#l00727">727</a> of file <a class="el" href="a00016_source.html">webby.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  MLOG_TRACE( <span class="stringliteral">&quot;webby - http header parsed&quot;</span> );
  
  <a class="code" href="a00005.html" title="structure is passed to filter function as argument.">FILTER_CONTEXT</a> *filter_data = (<a class="code" href="a00005.html" title="structure is passed to filter function as argument.">FILTER_CONTEXT</a> *) ctx;

  <span class="keywordflow">return</span> filter_data-&gt;<a class="code" href="a00005.html#ae9d9ee39035e778d3716187778febf40">filter</a>-&gt;<a class="code" href="a00006.html#a680109fd10e4d352a38426fb3832154d">on_request_header_parsed</a>(request, filter_data );
}
</pre></div>
</div>
</div>
<a class="anchor" id="a14b4ca97d7155383d1a5c97a27bb4944"></a><!-- doxytag: member="webby.c::http_on_message_data" ref="a14b4ca97d7155383d1a5c97a27bb4944" args="(HTTP_REQUEST *request, void *data, size_t data_size, void *ctx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int http_on_message_data </td>
          <td>(</td>
          <td class="paramtype">HTTP_REQUEST *&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>data_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="a00016_source.html#l00736">736</a> of file <a class="el" href="a00016_source.html">webby.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  MLOG_TRACE( <span class="stringliteral">&quot;webby - request body data parsed. size %u&quot;</span>, data_size );
  
  <a class="code" href="a00005.html" title="structure is passed to filter function as argument.">FILTER_CONTEXT</a> *filter_data = (<a class="code" href="a00005.html" title="structure is passed to filter function as argument.">FILTER_CONTEXT</a> *) ctx;

  <span class="keywordflow">return</span> filter_data-&gt;<a class="code" href="a00005.html#ae9d9ee39035e778d3716187778febf40">filter</a>-&gt;<a class="code" href="a00006.html#a6acb030789968d9a75fb32f3305c7a3c">on_request_data</a>( request, data, data_size, filter_data );
}
</pre></div>
</div>
</div>
<a class="anchor" id="ada6754658cfa8e6ac72c2f81497ea618"></a><!-- doxytag: member="webby.c::http_req_finished" ref="ada6754658cfa8e6ac72c2f81497ea618" args="(HTTP_REQUEST *request, void *ctx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int http_req_finished </td>
          <td>(</td>
          <td class="paramtype">HTTP_REQUEST *&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="a00016_source.html#l00745">745</a> of file <a class="el" href="a00016_source.html">webby.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  MLOG_TRACE( <span class="stringliteral">&quot;webby - request parsing finished&quot;</span> );
  
  <a class="code" href="a00005.html" title="structure is passed to filter function as argument.">FILTER_CONTEXT</a> *filter_data = (<a class="code" href="a00005.html" title="structure is passed to filter function as argument.">FILTER_CONTEXT</a> *) ctx;

  <span class="keywordflow">return</span> filter_data-&gt;<a class="code" href="a00005.html#ae9d9ee39035e778d3716187778febf40">filter</a>-&gt;<a class="code" href="a00006.html#ac171b2bcad117337da86aa482089ca8e">on_request_completed</a>( request, filter_data );
}
</pre></div>
</div>
</div>
<a class="anchor" id="a4f9df4e8f2785ac8500896ec74d4de09"></a><!-- doxytag: member="webby.c::SERVLET_FILTER_CONNECTION_CONTEXT_init" ref="a4f9df4e8f2785ac8500896ec74d4de09" args="(SERVLET_RUNNER_FILTER *rfilter)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00002.html">SERVLET_FILTER_CONNECTION_CONTEXT</a>* SERVLET_FILTER_CONNECTION_CONTEXT_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00011.html">SERVLET_RUNNER_FILTER</a> *&#160;</td>
          <td class="paramname"><em>rfilter</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="a00016_source.html#l00385">385</a> of file <a class="el" href="a00016_source.html">webby.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">size_t</span> nservlets;
  <a class="code" href="a00002.html">SERVLET_FILTER_CONNECTION_CONTEXT</a> *ret;
  <a class="code" href="a00010.html">SERVLET_CONTEXT</a> *cur;
  <a class="code" href="a00007.html" title="HTTP_SERVLET definition.">HTTP_SERVLET</a> **tmp;
  <span class="keywordtype">size_t</span>  i;


  nservlets = ARRAY_size( &amp;rfilter-&gt;<a class="code" href="a00011.html#a27adf1fb6122697009848353e59d6e08">servlets</a> );

  ret = malloc( <span class="keyword">sizeof</span>( <a class="code" href="a00002.html">SERVLET_FILTER_CONNECTION_CONTEXT</a> ) );
  <span class="keywordflow">if</span> (!ret) {
    <span class="keywordflow">return</span> 0;
  }

  ret-&gt;<a class="code" href="a00002.html#a06620f6d30a015b2341b8b42ed33ddc2">servlet_contexts</a> =  (<a class="code" href="a00010.html">SERVLET_CONTEXT</a> *) malloc( nservlets * <span class="keyword">sizeof</span>( <a class="code" href="a00010.html">SERVLET_CONTEXT</a> ) );
  <span class="keywordflow">if</span> (!ret-&gt;<a class="code" href="a00002.html#a06620f6d30a015b2341b8b42ed33ddc2">servlet_contexts</a>) {
    <span class="keywordflow">return</span> 0;
  }

  <span class="keywordflow">for</span>( i = 0, cur = ret-&gt;<a class="code" href="a00002.html#a06620f6d30a015b2341b8b42ed33ddc2">servlet_contexts</a>; i &lt; nservlets; ++i, ++cur) {
     cur-&gt;<a class="code" href="a00010.html#ae35983e812eaaa475a89740ab5f59be0">connection_ctx</a> = 0;
   
     tmp = (<a class="code" href="a00007.html" title="HTTP_SERVLET definition.">HTTP_SERVLET</a> **) ARRAY_at( &amp;rfilter-&gt;<a class="code" href="a00011.html#a27adf1fb6122697009848353e59d6e08">servlets</a>, i );
     cur-&gt;<a class="code" href="a00010.html#ac9b7bef690938dfbe412979fd0b499b0">servlet</a> =  *tmp;
  }
 
  DBUF_init( &amp;ret-&gt;<a class="code" href="a00002.html#a5943e99590e838a81c9743e51009eacf">request_data</a>, 0 );
  HTTP_RESPONSE_init( &amp;ret-&gt;<a class="code" href="a00002.html#a610bc014a866a5014d574b7b80f8bf2b">response</a>.<a class="code" href="a00009.html#aa55ce344b1ed261af07279c567b08d7b">response</a>, HTTP_VERSION_1_1, 501 );

  <span class="keywordflow">return</span> ret;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a86c88fca79c44bdc017513e1c03dc45d"></a><!-- doxytag: member="webby.c::SERVLET_RUNNER_FILTER_add_servlet" ref="a86c88fca79c44bdc017513e1c03dc45d" args="(SERVLET_RUNNER_FILTER *servlets, HTTP_SERVLET *servlet)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int SERVLET_RUNNER_FILTER_add_servlet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00011.html">SERVLET_RUNNER_FILTER</a> *&#160;</td>
          <td class="paramname"><em>servlets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00007.html">HTTP_SERVLET</a> *&#160;</td>
          <td class="paramname"><em>servlet</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="a00016_source.html#l00559">559</a> of file <a class="el" href="a00016_source.html">webby.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> (servlet-&gt;<a class="code" href="a00007.html#ae6a2bc9b9e2e7f7f00aab9b42ac237b0">init_servlet</a>) {
     <span class="keywordflow">if</span> (servlet-&gt;<a class="code" href="a00007.html#ae6a2bc9b9e2e7f7f00aab9b42ac237b0">init_servlet</a>( servlet )) {
       <span class="keywordflow">return</span> -1;
     }
  }
  <span class="keywordflow">return</span> ARRAY_push_back( &amp;servlets-&gt;<a class="code" href="a00011.html#a27adf1fb6122697009848353e59d6e08">servlets</a>, &amp;servlet, <span class="keyword">sizeof</span>( <span class="keywordtype">void</span> * ) );
}
</pre></div>
</div>
</div>
<a class="anchor" id="a21cf1ef43e78be908c81fca4e40b539b"></a><!-- doxytag: member="webby.c::SERVLET_RUNNER_FILTER_free" ref="a21cf1ef43e78be908c81fca4e40b539b" args="(SERVLET_RUNNER_FILTER *servlets)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SERVLET_RUNNER_FILTER_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00011.html">SERVLET_RUNNER_FILTER</a> *&#160;</td>
          <td class="paramname"><em>servlets</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="a00016_source.html#l00544">544</a> of file <a class="el" href="a00016_source.html">webby.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">size_t</span> i;
  <a class="code" href="a00007.html" title="HTTP_SERVLET definition.">HTTP_SERVLET</a> *servlet;
 
  <span class="keywordflow">for</span>(i = 0; i &lt; ARRAY_size( &amp;servlets-&gt;<a class="code" href="a00011.html#a27adf1fb6122697009848353e59d6e08">servlets</a> ); i++) {
    servlet = (<a class="code" href="a00007.html" title="HTTP_SERVLET definition.">HTTP_SERVLET</a> *) ARRAY_at( &amp;servlets-&gt;<a class="code" href="a00011.html#a27adf1fb6122697009848353e59d6e08">servlets</a>, i );
    <span class="keywordflow">if</span> (servlet-&gt;<a class="code" href="a00007.html#aeafcac3e6df66e734b92cc8d3c6e349a">free_servlet</a>) {
      servlet-&gt;<a class="code" href="a00007.html#aeafcac3e6df66e734b92cc8d3c6e349a">free_servlet</a>( servlet );
    }
  }
  ARRAY_free( &amp;servlets-&gt;<a class="code" href="a00011.html#a27adf1fb6122697009848353e59d6e08">servlets</a> );
  free( servlets );
}
</pre></div>
</div>
</div>
<a class="anchor" id="ae2e8a500699c277f9d7461f75e15c517"></a><!-- doxytag: member="webby.c::SERVLET_RUNNER_FILTER_init" ref="ae2e8a500699c277f9d7461f75e15c517" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00011.html">SERVLET_RUNNER_FILTER</a>* SERVLET_RUNNER_FILTER_init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="a00016_source.html#l00521">521</a> of file <a class="el" href="a00016_source.html">webby.c</a>.</p>
<div class="fragment"><pre class="fragment">{
   <a class="code" href="a00011.html">SERVLET_RUNNER_FILTER</a> *ret;

   ret = (<a class="code" href="a00011.html">SERVLET_RUNNER_FILTER</a> *) malloc( <span class="keyword">sizeof</span>( <a class="code" href="a00011.html">SERVLET_RUNNER_FILTER</a> ) );
   <span class="keywordflow">if</span> (!ret) {
     <span class="keywordflow">return</span> 0;
   }

   memset( &amp;ret-&gt;<a class="code" href="a00011.html#a5b653e293e834b6d2a167533a0ff7b1c">base</a>, 0, <span class="keyword">sizeof</span>( <a class="code" href="a00006.html" title="http filter definition">HTTP_FILTER</a> ) );
   ret-&gt;<a class="code" href="a00011.html#a5b653e293e834b6d2a167533a0ff7b1c">base</a>.<a class="code" href="a00006.html#a680109fd10e4d352a38426fb3832154d">on_request_header_parsed</a> = <a class="code" href="a00016.html#a7d1a1a1862eeb63a0a4f4b7bcc0152c7">servlets_req_header_parsed</a>;
   ret-&gt;<a class="code" href="a00011.html#a5b653e293e834b6d2a167533a0ff7b1c">base</a>.<a class="code" href="a00006.html#a6acb030789968d9a75fb32f3305c7a3c">on_request_data</a> = <a class="code" href="a00016.html#a223c0d62cecfa47dcbf0e083b720ffd7">servlets_req_on_message_data</a>;
   ret-&gt;<a class="code" href="a00011.html#a5b653e293e834b6d2a167533a0ff7b1c">base</a>.<a class="code" href="a00006.html#ac171b2bcad117337da86aa482089ca8e">on_request_completed</a> = <a class="code" href="a00016.html#ad84e5be2ed54a5e98bc4c82fd8768926">servlets_req_finished</a>;      
   ret-&gt;<a class="code" href="a00011.html#a5b653e293e834b6d2a167533a0ff7b1c">base</a>.<a class="code" href="a00006.html#a4e7c8380d5073fb0596d2ac4950c309f">on_connection_close</a> = <a class="code" href="a00016.html#a0dfe75c88868c24edd8f7fb1d1dea130">servlets_connection_close</a>;

   <span class="keywordflow">if</span> (ARRAY_init( &amp;ret-&gt;<a class="code" href="a00011.html#a27adf1fb6122697009848353e59d6e08">servlets</a>, <span class="keyword">sizeof</span>( <span class="keywordtype">void</span> * ), 10 ) ) {
     free( ret );
     <span class="keywordflow">return</span> 0;
   }

   <span class="keywordflow">return</span> ret;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0dfe75c88868c24edd8f7fb1d1dea130"></a><!-- doxytag: member="webby.c::servlets_connection_close" ref="a0dfe75c88868c24edd8f7fb1d1dea130" args="(FILTER_CONTEXT *context)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int servlets_connection_close </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00005.html">FILTER_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>context</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="a00016_source.html#l00502">502</a> of file <a class="el" href="a00016_source.html">webby.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">size_t</span> i;
  <a class="code" href="a00002.html">SERVLET_FILTER_CONNECTION_CONTEXT</a> *fcontext = (<a class="code" href="a00002.html">SERVLET_FILTER_CONNECTION_CONTEXT</a> * ) context-&gt;<a class="code" href="a00005.html#a67ef86adee752b865e229fcf29b9ed90">connection_ctx</a>;
  <a class="code" href="a00011.html">SERVLET_RUNNER_FILTER</a> *runner = (<a class="code" href="a00011.html">SERVLET_RUNNER_FILTER</a> *) context-&gt;<a class="code" href="a00005.html#ae9d9ee39035e778d3716187778febf40">filter</a>; 
  <a class="code" href="a00010.html">SERVLET_CONTEXT</a> *scontext;

  <span class="keywordflow">if</span> (!fcontext-&gt;<a class="code" href="a00002.html#a06620f6d30a015b2341b8b42ed33ddc2">servlet_contexts</a>) {
    <span class="keywordflow">return</span> 0;
  }

  <span class="keywordflow">for</span>(i = 0, scontext = (<a class="code" href="a00010.html">SERVLET_CONTEXT</a> *) fcontext-&gt;<a class="code" href="a00002.html#a06620f6d30a015b2341b8b42ed33ddc2">servlet_contexts</a>;  i &lt; ARRAY_size( &amp;runner-&gt;servlets ); ++i, ++scontext) {
     <span class="keywordflow">if</span> (scontext-&gt;<a class="code" href="a00010.html#ac9b7bef690938dfbe412979fd0b499b0">servlet</a>-&gt;<a class="code" href="a00007.html#a567b7d99882c8714c6a30ab41de0644a">free_connection</a>) {
       scontext-&gt;<a class="code" href="a00010.html#ac9b7bef690938dfbe412979fd0b499b0">servlet</a>-&gt;<a class="code" href="a00007.html#a567b7d99882c8714c6a30ab41de0644a">free_connection</a>( scontext ); 
     }
  }
  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ad84e5be2ed54a5e98bc4c82fd8768926"></a><!-- doxytag: member="webby.c::servlets_req_finished" ref="ad84e5be2ed54a5e98bc4c82fd8768926" args="(HTTP_REQUEST *request, FILTER_CONTEXT *context)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int servlets_req_finished </td>
          <td>(</td>
          <td class="paramtype">HTTP_REQUEST *&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00005.html">FILTER_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="a00016_source.html#l00444">444</a> of file <a class="el" href="a00016_source.html">webby.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">size_t</span> i;
  <a class="code" href="a00001.html">RDATA</a> rd;

  <a class="code" href="a00002.html">SERVLET_FILTER_CONNECTION_CONTEXT</a> *fcontext = (<a class="code" href="a00002.html">SERVLET_FILTER_CONNECTION_CONTEXT</a> * ) context-&gt;<a class="code" href="a00005.html#a67ef86adee752b865e229fcf29b9ed90">connection_ctx</a>;
  <a class="code" href="a00011.html">SERVLET_RUNNER_FILTER</a> *runner = (<a class="code" href="a00011.html">SERVLET_RUNNER_FILTER</a> *) context-&gt;<a class="code" href="a00005.html#ae9d9ee39035e778d3716187778febf40">filter</a>; 
  <a class="code" href="a00010.html">SERVLET_CONTEXT</a> *scontext;
  <a class="code" href="a00020.html#ga62da94570530db808ca7a449c02142a1">SERVLET_STATUS</a> status; 

  <span class="keywordflow">if</span> ( request-&gt;expect_100_continue) {
     
    rd.<a class="code" href="a00001.html#a47df03eb99f239c14e83ff9527b8a97b">no_chunk</a>.<a class="code" href="a00001.html#a3ff50d24d705be48dd99ef32cfa0ad34">data</a> = <a class="code" href="a00016.html#a2015bcbf6c5384890d22567bba40056d">HTTP_100_CONTINUE_RESPONSE</a>;
    rd.<a class="code" href="a00001.html#a47df03eb99f239c14e83ff9527b8a97b">no_chunk</a>.<a class="code" href="a00001.html#a5025856b2bd77112fef2041fd64b33e9">data_size</a> =  <a class="code" href="a00016.html#a5847d13704437f4dddb4ef4671dabb7d">HTTP_100_CONTINUE_RESPONSE_LEN</a>; 

    <span class="keywordflow">if</span> (<a class="code" href="a00019.html#ga9f0f204b55f36f27c0fb680faf7e1305" title="called by implementaiton of HTTP_FILTER_RESPONSE_DATA filter callback, calls the next filter in the c...">call_next_filter_response_data</a> ( 0, 0, rd,  context  ) ) {
      <span class="keywordflow">return</span> -1;
    }
  } 

  fcontext-&gt;<a class="code" href="a00002.html#ac73b259830b18eb77f26c79356c78d60">request</a>.<a class="code" href="a00008.html#a7341bff4e78abe9aa746d6c52e2eaa20">request</a> = request;
  fcontext-&gt;<a class="code" href="a00002.html#ac73b259830b18eb77f26c79356c78d60">request</a>.<a class="code" href="a00008.html#a427d50a189aafc2db7b033acf64d69ef">request_data</a> = fcontext-&gt;<a class="code" href="a00002.html#aa14b3f0925116dad2ea0579eee21bf76">buff</a>;
 
  HTTP_RESPONSE_free( &amp;fcontext-&gt;<a class="code" href="a00002.html#a610bc014a866a5014d574b7b80f8bf2b">response</a>.<a class="code" href="a00009.html#aa55ce344b1ed261af07279c567b08d7b">response</a> );
  HTTP_RESPONSE_init( &amp;fcontext-&gt;<a class="code" href="a00002.html#a610bc014a866a5014d574b7b80f8bf2b">response</a>.<a class="code" href="a00009.html#aa55ce344b1ed261af07279c567b08d7b">response</a>, request-&gt;version, 501 );
  fcontext-&gt;<a class="code" href="a00002.html#a610bc014a866a5014d574b7b80f8bf2b">response</a>.<a class="code" href="a00009.html#acfe932960b95d037da48c87fc27beb79">request</a> = request;
  fcontext-&gt;<a class="code" href="a00002.html#a610bc014a866a5014d574b7b80f8bf2b">response</a>.<a class="code" href="a00009.html#a6807441c52560f55d6016a13404cd641">filter_context</a> = context;
  fcontext-&gt;<a class="code" href="a00002.html#a610bc014a866a5014d574b7b80f8bf2b">response</a>.<a class="code" href="a00009.html#a03492116d30e34715724cc33f5fe52e5">data_sent</a> = 0;
  fcontext-&gt;<a class="code" href="a00002.html#a610bc014a866a5014d574b7b80f8bf2b">response</a>.<a class="code" href="a00009.html#a1e5ec22738cccb12b9b3bdcdd431f168">state</a> = 0;
  fcontext-&gt;<a class="code" href="a00002.html#a610bc014a866a5014d574b7b80f8bf2b">response</a>.<a class="code" href="a00009.html#a6271be8a3acfe1eb86179de567a912f3">chunk_buf</a> = 0;
  fcontext-&gt;<a class="code" href="a00002.html#a610bc014a866a5014d574b7b80f8bf2b">response</a>.<a class="code" href="a00009.html#abf0aa9810763fa4c8edd2d0fbfb1004a">chunk_buf_size</a> = 0;
  fcontext-&gt;<a class="code" href="a00002.html#a610bc014a866a5014d574b7b80f8bf2b">response</a>.<a class="code" href="a00009.html#a83454d920f7218661b367f6cd9e3f3f3">chunk_no</a> = 0;


 
  <span class="keywordflow">for</span>(i = 0, scontext = (<a class="code" href="a00010.html">SERVLET_CONTEXT</a> *) fcontext-&gt;<a class="code" href="a00002.html#a06620f6d30a015b2341b8b42ed33ddc2">servlet_contexts</a>;  i &lt; ARRAY_size( &amp;runner-&gt;servlets ); ++i, ++scontext) {
     status = scontext-&gt;<a class="code" href="a00010.html#ac9b7bef690938dfbe412979fd0b499b0">servlet</a>-&gt;<a class="code" href="a00007.html#ac176bbe2e49c194f8cee4f5a7ad4b855">servlet_action</a>( &amp;fcontext-&gt;<a class="code" href="a00002.html#ac73b259830b18eb77f26c79356c78d60">request</a>, &amp;fcontext-&gt;<a class="code" href="a00002.html#a610bc014a866a5014d574b7b80f8bf2b">response</a>, scontext );  
     <span class="keywordflow">if</span> (status == <a class="code" href="a00020.html#gga62da94570530db808ca7a449c02142a1afe95521ecb510198d8d464d9e0c5d30e">SERVLET_REQUEST_HANDLED</a>) {
       <span class="keywordflow">return</span> 0;
     }
     <span class="keywordflow">if</span> (status == <a class="code" href="a00020.html#gga62da94570530db808ca7a449c02142a1a0212a1ce85c57b14397e080fe6249e78">SERVLET_REQUEST_ERROR</a>) {
       
       rd.<a class="code" href="a00001.html#a47df03eb99f239c14e83ff9527b8a97b">no_chunk</a>.<a class="code" href="a00001.html#a3ff50d24d705be48dd99ef32cfa0ad34">data</a> =  <a class="code" href="a00016.html#a7c23b56c42f83405f572a89b1c562236">HTTP_500_SERVER_ERROR</a>;
       rd.<a class="code" href="a00001.html#a47df03eb99f239c14e83ff9527b8a97b">no_chunk</a>.<a class="code" href="a00001.html#a5025856b2bd77112fef2041fd64b33e9">data_size</a> = <a class="code" href="a00016.html#aeac2904b4dc3e9bc8665967226a7ad81">HTTP_500_SERVER_ERROR_LEN</a>; 

       <a class="code" href="a00019.html#ga9f0f204b55f36f27c0fb680faf7e1305" title="called by implementaiton of HTTP_FILTER_RESPONSE_DATA filter callback, calls the next filter in the c...">call_next_filter_response_data</a>( 0, 0, rd,  context );
       <span class="keywordflow">return</span> -1;
     }
  }
 
  rd.<a class="code" href="a00001.html#a47df03eb99f239c14e83ff9527b8a97b">no_chunk</a>.<a class="code" href="a00001.html#a3ff50d24d705be48dd99ef32cfa0ad34">data</a> =  <a class="code" href="a00016.html#aa329368df498e3841e168fd0f2487ca9">HTTP_404_NOT_FOUND</a>;
  rd.<a class="code" href="a00001.html#a47df03eb99f239c14e83ff9527b8a97b">no_chunk</a>.<a class="code" href="a00001.html#a5025856b2bd77112fef2041fd64b33e9">data_size</a> =   <a class="code" href="a00016.html#ad1a3e36a0d6be4f97e74c772e17db0f6">HTTP_404_NOT_FOUND_LEN</a>; 

  <a class="code" href="a00019.html#ga9f0f204b55f36f27c0fb680faf7e1305" title="called by implementaiton of HTTP_FILTER_RESPONSE_DATA filter callback, calls the next filter in the c...">call_next_filter_response_data</a>( 0, 0, rd,  context );
 
  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a7d1a1a1862eeb63a0a4f4b7bcc0152c7"></a><!-- doxytag: member="webby.c::servlets_req_header_parsed" ref="a7d1a1a1862eeb63a0a4f4b7bcc0152c7" args="(HTTP_REQUEST *request, FILTER_CONTEXT *context)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int servlets_req_header_parsed </td>
          <td>(</td>
          <td class="paramtype">HTTP_REQUEST *&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00005.html">FILTER_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="a00016_source.html#l00420">420</a> of file <a class="el" href="a00016_source.html">webby.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  M_UNUSED( request );
  
  <span class="keywordflow">if</span> (!context-&gt;<a class="code" href="a00005.html#a67ef86adee752b865e229fcf29b9ed90">connection_ctx</a>) {
    context-&gt;<a class="code" href="a00005.html#a67ef86adee752b865e229fcf29b9ed90">connection_ctx</a> = <a class="code" href="a00016.html#a4f9df4e8f2785ac8500896ec74d4de09">SERVLET_FILTER_CONNECTION_CONTEXT_init</a>( (<a class="code" href="a00011.html">SERVLET_RUNNER_FILTER</a> *) context-&gt;<a class="code" href="a00005.html#ae9d9ee39035e778d3716187778febf40">filter</a> );
  }
  <span class="keywordflow">if</span> (! context-&gt;<a class="code" href="a00005.html#a67ef86adee752b865e229fcf29b9ed90">connection_ctx</a>) {
    <span class="keywordflow">return</span> -1;
  }

  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a223c0d62cecfa47dcbf0e083b720ffd7"></a><!-- doxytag: member="webby.c::servlets_req_on_message_data" ref="a223c0d62cecfa47dcbf0e083b720ffd7" args="(HTTP_REQUEST *request, void *data, size_t data_size, FILTER_CONTEXT *context)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int servlets_req_on_message_data </td>
          <td>(</td>
          <td class="paramtype">HTTP_REQUEST *&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>data_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00005.html">FILTER_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="a00016_source.html#l00435">435</a> of file <a class="el" href="a00016_source.html">webby.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="a00002.html">SERVLET_FILTER_CONNECTION_CONTEXT</a> *fcontext = (<a class="code" href="a00002.html">SERVLET_FILTER_CONNECTION_CONTEXT</a> * ) context-&gt;<a class="code" href="a00005.html#a67ef86adee752b865e229fcf29b9ed90">connection_ctx</a>;

  M_UNUSED( request );
  <span class="keywordflow">return</span> DBUF_add( &amp;fcontext-&gt;<a class="code" href="a00002.html#a5943e99590e838a81c9743e51009eacf">request_data</a>, data, data_size );
}
</pre></div>
</div>
</div>
<a class="anchor" id="af77c4d76ab2670314f249617de68fd5d"></a><!-- doxytag: member="webby.c::sink_connection_close" ref="af77c4d76ab2670314f249617de68fd5d" args="(FILTER_CONTEXT *context)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int sink_connection_close </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00005.html">FILTER_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>context</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="a00016_source.html#l00260">260</a> of file <a class="el" href="a00016_source.html">webby.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> (context-&gt;<a class="code" href="a00005.html#a67ef86adee752b865e229fcf29b9ed90">connection_ctx</a>) {
    free( context-&gt;<a class="code" href="a00005.html#a67ef86adee752b865e229fcf29b9ed90">connection_ctx</a>);
  }
  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aa71d1b94a4004acfa1d58c9535bea773"></a><!-- doxytag: member="webby.c::sink_on_response_complete" ref="aa71d1b94a4004acfa1d58c9535bea773" args="(HTTP_RESPONSE *response, FILTER_CONTEXT *context)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int sink_on_response_complete </td>
          <td>(</td>
          <td class="paramtype">HTTP_RESPONSE *&#160;</td>
          <td class="paramname"><em>response</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00005.html">FILTER_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="a00016_source.html#l00251">251</a> of file <a class="el" href="a00016_source.html">webby.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="a00004.html">DATA_SINK_FILTER_CONNECTION_CONTEXT</a> *sink = (<a class="code" href="a00004.html">DATA_SINK_FILTER_CONNECTION_CONTEXT</a> *)  context-&gt;<a class="code" href="a00005.html#a67ef86adee752b865e229fcf29b9ed90">connection_ctx</a>;

  M_UNUSED( response );
 
  <span class="keywordflow">return</span> <a class="code" href="a00025.html#ga9590a8c114565d5e3a27c33a4c0b1fbf">WEBBY_impl_response_completed</a>( sink-&gt;<a class="code" href="a00004.html#a21ea3e61a86610196315cefee2f71897">impl_connection_ctx</a>, response-&gt;base.flags &amp; HTTP_MESSAGE_FLAG_CONNECTION_CLOSE );
}
</pre></div>
</div>
</div>
<a class="anchor" id="a2579884d18879e342c318b215e40e8dc"></a><!-- doxytag: member="webby.c::sink_on_response_data" ref="a2579884d18879e342c318b215e40e8dc" args="(HTTP_RESPONSE *response, int is_chunk, RDATA rdata, FILTER_CONTEXT *context)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int sink_on_response_data </td>
          <td>(</td>
          <td class="paramtype">HTTP_RESPONSE *&#160;</td>
          <td class="paramname"><em>response</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>is_chunk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00001.html">RDATA</a>&#160;</td>
          <td class="paramname"><em>rdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00005.html">FILTER_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="a00016_source.html#l00200">200</a> of file <a class="el" href="a00016_source.html">webby.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="a00004.html">DATA_SINK_FILTER_CONNECTION_CONTEXT</a> *sink = (<a class="code" href="a00004.html">DATA_SINK_FILTER_CONNECTION_CONTEXT</a> *)  context-&gt;<a class="code" href="a00005.html#a67ef86adee752b865e229fcf29b9ed90">connection_ctx</a>;
  BF *bf;
  <span class="keywordtype">void</span> *data;
  <span class="keywordtype">size_t</span> size;
  <span class="keywordtype">int</span> len;
  <span class="keywordtype">char</span> chunk_header[ 20 ];

  M_UNUSED( response );

  <span class="keywordflow">if</span> (!is_chunk) {
    <span class="keywordflow">return</span> <a class="code" href="a00025.html#ga0cfa9e0e763976b6d9905076eb9f2fc1">WEBBY_impl_send_data</a>( sink-&gt;<a class="code" href="a00004.html#a21ea3e61a86610196315cefee2f71897">impl_connection_ctx</a>, rdata.<a class="code" href="a00001.html#a47df03eb99f239c14e83ff9527b8a97b">no_chunk</a>.<a class="code" href="a00001.html#a3ff50d24d705be48dd99ef32cfa0ad34">data</a>, rdata.<a class="code" href="a00001.html#a47df03eb99f239c14e83ff9527b8a97b">no_chunk</a>.<a class="code" href="a00001.html#a5025856b2bd77112fef2041fd64b33e9">data_size</a> );
  }
  
  bf = rdata.<a class="code" href="a00001.html#a493098fc4beb27d6c267fe2bd649c2de">chunk</a>.<a class="code" href="a00001.html#a626fdc4af5978bfaca650f930d5eeeac">bf</a>;
  <span class="keywordflow">if</span> (bf) { 
    <span class="keywordflow">if</span> (rdata.<a class="code" href="a00001.html#a493098fc4beb27d6c267fe2bd649c2de">chunk</a>.<a class="code" href="a00001.html#a35c09a09a98b296c7ed641b70f8510eb">chunk_no</a>) {
      len = snprintf( chunk_header, <span class="keyword">sizeof</span>( chunk_header ),  <span class="stringliteral">&quot;\r\n%x\r\n&quot;</span>, BF_get_size(bf)  );
    } <span class="keywordflow">else</span> {
      len = snprintf( chunk_header, <span class="keyword">sizeof</span>( chunk_header ),  <span class="stringliteral">&quot;%x\r\n&quot;</span>, BF_get_size(bf) );
    }
    <span class="keywordflow">if</span> ( (bf-&gt;start - bf-&gt;bf) &lt; len) {
      MLOG_INFO( <span class="stringliteral">&quot;Failed to send chunk - buffer did not reserved enough room before start of chunk data&quot;</span> );
      <span class="keywordflow">return</span> -1;
    }
    bf-&gt;start -= len;
    strncpy( (<span class="keywordtype">char</span> *) bf-&gt;start, chunk_header, len );
 
    <span class="keywordflow">if</span> (<a class="code" href="a00025.html#ga0cfa9e0e763976b6d9905076eb9f2fc1">WEBBY_impl_send_data</a>( sink-&gt;<a class="code" href="a00004.html#a21ea3e61a86610196315cefee2f71897">impl_connection_ctx</a>, bf-&gt;start, bf-&gt;put_pos - bf-&gt;start  )) {
     MLOG_INFO( <span class="stringliteral">&quot;Failed to send chunk data&quot;</span> );
    }
 
  } <span class="keywordflow">else</span> {
    
    <span class="keywordflow">if</span> (rdata.<a class="code" href="a00001.html#a493098fc4beb27d6c267fe2bd649c2de">chunk</a>.<a class="code" href="a00001.html#a35c09a09a98b296c7ed641b70f8510eb">chunk_no</a>) {
      data = <a class="code" href="a00016.html#a7f05649123949a8e965870c97010f80e">LAST_CHUNK_NOT_FIRST</a>;
      size = <a class="code" href="a00016.html#aab62a761d0efd5b816b635391ca69f8b">LAST_CHUNK_NOT_FIRST_SIZE</a>;
    } <span class="keywordflow">else</span> {
      data = <a class="code" href="a00016.html#a62c1114c9b862ff891296691c7564ac7">LAST_CHUNK_FIRST</a>;
      size = <a class="code" href="a00016.html#acb30928d1b99967ceedfadeebc124151">LAST_CHUNK_FIRST_SIZE</a>;
    }
    <span class="keywordflow">if</span> (<a class="code" href="a00025.html#ga0cfa9e0e763976b6d9905076eb9f2fc1">WEBBY_impl_send_data</a>( sink-&gt;<a class="code" href="a00004.html#a21ea3e61a86610196315cefee2f71897">impl_connection_ctx</a>, data, size  )) {
      MLOG_INFO( <span class="stringliteral">&quot;Failed to send chunk data&quot;</span> );
    }
 
  }
  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a4e52cf5f68c18c32dcad138f7f444a09"></a><!-- doxytag: member="webby.c::sink_on_response_header" ref="a4e52cf5f68c18c32dcad138f7f444a09" args="(HTTP_RESPONSE *response, FILTER_CONTEXT *context)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int sink_on_response_header </td>
          <td>(</td>
          <td class="paramtype">HTTP_RESPONSE *&#160;</td>
          <td class="paramname"><em>response</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00005.html">FILTER_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="a00016_source.html#l00168">168</a> of file <a class="el" href="a00016_source.html">webby.c</a>.</p>
<div class="fragment"><pre class="fragment">{
   <a class="code" href="a00004.html">DATA_SINK_FILTER_CONNECTION_CONTEXT</a> *sink = (<a class="code" href="a00004.html">DATA_SINK_FILTER_CONNECTION_CONTEXT</a> *)  context-&gt;<a class="code" href="a00005.html#a67ef86adee752b865e229fcf29b9ed90">connection_ctx</a>;
   BF *bf;
   PARSER_STATUS stat;
   bf = sink-&gt;<a class="code" href="a00004.html#af3a9d3d154e3d743999c45d4d3ea9714">out_buf</a>;
   HTTP_RESPONSE_WRITER_init( &amp;sink-&gt;<a class="code" href="a00004.html#a76f71af457f0df30ad77e4709a8816a9">writer</a>, response );
   
   <span class="keywordflow">while</span>(1) { 
    stat =  HTTP_RESPONSE_WRITER_write( &amp;sink-&gt;<a class="code" href="a00004.html#a76f71af457f0df30ad77e4709a8816a9">writer</a>, bf );
    <span class="keywordflow">switch</span>(stat) {
      <span class="keywordflow">case</span> PARSER_STATUS_ERROR:
        MLOG_INFO( <span class="stringliteral">&quot;Failed to format response header&quot;</span> );
        <span class="keywordflow">return</span> -1;
      <span class="keywordflow">case</span> PARSER_STATUS_COMPLETED:
        <span class="keywordflow">if</span> (<a class="code" href="a00025.html#ga0cfa9e0e763976b6d9905076eb9f2fc1">WEBBY_impl_send_data</a>( sink-&gt;<a class="code" href="a00004.html#a21ea3e61a86610196315cefee2f71897">impl_connection_ctx</a>, bf-&gt;get_pos, BF_get_size( bf ) ) ) {
          MLOG_INFO( <span class="stringliteral">&quot;Failed to send response header&quot;</span> );
          <span class="keywordflow">return</span> -1;
        }
        <span class="keywordflow">return</span> 0;

      <span class="keywordflow">case</span> PARSER_STATUS_NEED_MORE_DATA:
        <span class="keywordflow">if</span> (<a class="code" href="a00025.html#ga0cfa9e0e763976b6d9905076eb9f2fc1">WEBBY_impl_send_data</a>( sink-&gt;<a class="code" href="a00004.html#a21ea3e61a86610196315cefee2f71897">impl_connection_ctx</a>, bf-&gt;get_pos, BF_get_size( bf ) ) ) {
          MLOG_INFO( <span class="stringliteral">&quot;Failed to send response header&quot;</span> );
          <span class="keywordflow">return</span> -1;
        }
        <span class="keywordflow">break</span>;
    }
  } <span class="keywordflow">while</span>( 1 );

}
</pre></div>
</div>
</div>
<a class="anchor" id="a490c00eaaa1279aa373aa08b63ed572e"></a><!-- doxytag: member="webby.c::sink_req_completed" ref="a490c00eaaa1279aa373aa08b63ed572e" args="(HTTP_REQUEST *request, FILTER_CONTEXT *context)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int sink_req_completed </td>
          <td>(</td>
          <td class="paramtype">HTTP_REQUEST *&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00005.html">FILTER_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="a00016_source.html#l00155">155</a> of file <a class="el" href="a00016_source.html">webby.c</a>.</p>
<div class="fragment"><pre class="fragment">{ 
  <a class="code" href="a00004.html">DATA_SINK_FILTER_CONNECTION_CONTEXT</a> * sink;

  sink = (<a class="code" href="a00004.html">DATA_SINK_FILTER_CONNECTION_CONTEXT</a> *) context;
  <span class="keywordflow">if</span> (sink-&gt;<a class="code" href="a00004.html#a90a9c5702903bcb1f94632ecf6c8828e">next_request_filter</a> == (<span class="keywordtype">size_t</span>) -1) {
    <span class="keywordflow">return</span> <a class="code" href="a00019.html#ga0640b7d009a7e522d8ca1482f521a453" title="called by implementaiton of HTTP_FILTER_REQUEST_COMPLETED filter callback, calls the next filter in t...">call_next_filter_request_completed</a>( request, context );
  }
  
  context = context + sink-&gt;<a class="code" href="a00004.html#a90a9c5702903bcb1f94632ecf6c8828e">next_request_filter</a>;
  <span class="keywordflow">return</span> context-&gt;<a class="code" href="a00005.html#ae9d9ee39035e778d3716187778febf40">filter</a>-&gt;<a class="code" href="a00006.html#ac171b2bcad117337da86aa482089ca8e">on_request_completed</a>( request, context );
} 
</pre></div>
</div>
</div>
<a class="anchor" id="adda20398a8edb8125382ba5001294e58"></a><!-- doxytag: member="webby.c::sink_req_data" ref="adda20398a8edb8125382ba5001294e58" args="(HTTP_REQUEST *request, void *data, size_t data_size, FILTER_CONTEXT *context)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int sink_req_data </td>
          <td>(</td>
          <td class="paramtype">HTTP_REQUEST *&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>data_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00005.html">FILTER_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="a00016_source.html#l00142">142</a> of file <a class="el" href="a00016_source.html">webby.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="a00004.html">DATA_SINK_FILTER_CONNECTION_CONTEXT</a> * sink;

  sink = (<a class="code" href="a00004.html">DATA_SINK_FILTER_CONNECTION_CONTEXT</a> *) context;
  <span class="keywordflow">if</span> (sink-&gt;<a class="code" href="a00004.html#a90a9c5702903bcb1f94632ecf6c8828e">next_request_filter</a> == (<span class="keywordtype">size_t</span>) -1) {
    <span class="keywordflow">return</span> <a class="code" href="a00019.html#ga039bb80f347f613afb853cfd74478630" title="called by implementaiton of HTTP_FILTER_REQUEST_DATA filter callback, calls the next filter in the ch...">call_next_filter_request_data</a>( request, data, data_size, context ); 
  }
  
  context = context + sink-&gt;<a class="code" href="a00004.html#a90a9c5702903bcb1f94632ecf6c8828e">next_request_filter</a>; 
  <span class="keywordflow">return</span> context-&gt;<a class="code" href="a00005.html#ae9d9ee39035e778d3716187778febf40">filter</a>-&gt;<a class="code" href="a00006.html#a6acb030789968d9a75fb32f3305c7a3c">on_request_data</a>( request, data, data_size, context );
}
</pre></div>
</div>
</div>
<a class="anchor" id="a601da19b20c63ad3bb7ba3a16916b7f0"></a><!-- doxytag: member="webby.c::sink_req_header_parsed" ref="a601da19b20c63ad3bb7ba3a16916b7f0" args="(HTTP_REQUEST *request, FILTER_CONTEXT *context)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int sink_req_header_parsed </td>
          <td>(</td>
          <td class="paramtype">HTTP_REQUEST *&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00005.html">FILTER_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="a00016_source.html#l00081">81</a> of file <a class="el" href="a00016_source.html">webby.c</a>.</p>
<div class="fragment"><pre class="fragment">{ 
  <a class="code" href="a00003.html">DATA_SINK_FILTER</a> *sink_filter; 
  <a class="code" href="a00004.html">DATA_SINK_FILTER_CONNECTION_CONTEXT</a> *sink;
  <a class="code" href="a00012.html">VIRTUAL_HOST_DEFINITION</a> *vhosts_def; 
  <span class="keywordtype">size_t</span> i, found;
  <a class="code" href="a00001.html">RDATA</a> rd;


  <span class="comment">// no host header in HTTP 1.0; go to the next filter.</span>
  <span class="keywordflow">if</span> (request-&gt;version == HTTP_VERSION_1_0) {
    <span class="keywordflow">return</span> <a class="code" href="a00019.html#gaa72af13e42b9712dcd6651373796ebdc" title="called by implementaiton of HTTP_FILTER_REQUEST_HEADER_PARSED filter callback, calls the next filter ...">call_next_filter_request_header_parsed</a>( request, context );
  }

  <span class="comment">// presence of Host header is absolutely required with HTTP/1.1</span>
  <span class="keywordflow">if</span> (!request-&gt;has_host_header) {
     MLOG_INFO( <span class="stringliteral">&quot;HTTP/1.1 no host header&quot;</span> ); 
     <span class="keywordflow">goto</span> bad_request;
  }

  sink_filter = (<a class="code" href="a00003.html">DATA_SINK_FILTER</a> *) context-&gt;<a class="code" href="a00005.html#ae9d9ee39035e778d3716187778febf40">filter</a>;
  if (ARRAY_size( &amp;sink_filter-&gt;<a class="code" href="a00003.html#a9c6f8e0600fbd38e03b0538b0407c3f0">vhosts</a> ) == 0)  {
    <span class="keywordflow">return</span> <a class="code" href="a00019.html#gaa72af13e42b9712dcd6651373796ebdc" title="called by implementaiton of HTTP_FILTER_REQUEST_HEADER_PARSED filter callback, calls the next filter ...">call_next_filter_request_header_parsed</a>( request, context );
  }

  <span class="comment">// find which virtua host corresponds to the request host entry</span>
  <span class="keywordflow">for</span>( found = i = 0, vhosts_def = (<a class="code" href="a00012.html">VIRTUAL_HOST_DEFINITION</a> *) ARRAY_at( &amp;sink_filter-&gt;<a class="code" href="a00003.html#a9c6f8e0600fbd38e03b0538b0407c3f0">vhosts</a>, 0 ); 
       i &lt; ARRAY_size( &amp;sink_filter-&gt;<a class="code" href="a00003.html#a9c6f8e0600fbd38e03b0538b0407c3f0">vhosts</a>); 
       ++i, ++vhosts_def ) {

     <span class="keywordflow">if</span> ( strcmp( request-&gt;host_header, vhosts_def-&gt;<a class="code" href="a00012.html#a9a11ee99cbd8cbb85c822bab961e51fa">host</a> ) == 0 &amp;&amp; request-&gt;host_header_port == vhosts_def-&gt;<a class="code" href="a00012.html#a7e6172f0c4d87cfc3692d85b7a03ebaa">host_port</a>) {
       found = 1;
       <span class="keywordflow">break</span>;
     }
  }

  <span class="keywordflow">if</span> (!found) {
     MLOG_INFO( <span class="stringliteral">&quot;Host header %s %d does not correspond to any virtual hosts&quot;</span>, request-&gt;host_header, request-&gt;host_header_port ); 
     <span class="keywordflow">goto</span> bad_request;
  }
  
  <span class="comment">// now that the virtual host is found - remember the next filter index for the following notifications.</span>
  sink = (<a class="code" href="a00004.html">DATA_SINK_FILTER_CONNECTION_CONTEXT</a> *) context;
  sink-&gt;<a class="code" href="a00004.html#a90a9c5702903bcb1f94632ecf6c8828e">next_request_filter</a> = vhosts_def-&gt;<a class="code" href="a00012.html#a765532c34c7267a755f02fc24f31461c">next_filter_idx</a>; 
 
  <span class="comment">// call next filter.</span>
  context = context + vhosts_def-&gt;<a class="code" href="a00012.html#a765532c34c7267a755f02fc24f31461c">next_filter_idx</a>;
  <span class="keywordflow">return</span> context-&gt;<a class="code" href="a00005.html#ae9d9ee39035e778d3716187778febf40">filter</a>-&gt;<a class="code" href="a00006.html#a680109fd10e4d352a38426fb3832154d">on_request_header_parsed</a>( request, context );

bad_request:
  rd.<a class="code" href="a00001.html#a47df03eb99f239c14e83ff9527b8a97b">no_chunk</a>.<a class="code" href="a00001.html#a3ff50d24d705be48dd99ef32cfa0ad34">data</a> =  <a class="code" href="a00016.html#a080daa68e2273c3375d0adb8a5a5c0ea">HTTP_400_BAD_REQUEST</a>;
  rd.<a class="code" href="a00001.html#a47df03eb99f239c14e83ff9527b8a97b">no_chunk</a>.<a class="code" href="a00001.html#a5025856b2bd77112fef2041fd64b33e9">data_size</a> =  <a class="code" href="a00016.html#a3c18a0d90bc1c9f3b6d7a2d469c10570">HTTP_400_BAD_REQUEST_LEN</a>; 

  context-&gt;<a class="code" href="a00005.html#ae9d9ee39035e778d3716187778febf40">filter</a>-&gt;<a class="code" href="a00006.html#a7505d786cec72de0641211b0da6b5b75">on_response_data</a>( 0, 0, rd, context );
  <span class="comment">//call_next_filter_response_data( 0, 0, rd, context );</span>
  <span class="keywordflow">return</span> -1;
 
}
</pre></div>
</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Oct 25 2011 01:10:44 for WEBBY - the embedded web server with many faces / objects in plain C by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
